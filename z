#!/usr/bin/mythryl

mutex = pthread::make_mutex ();
pthread::set_up_mutex (mutex, NULL);
pthread::acquire_mutex mutex;

fun subthread_fn ()
    =
    {   if ((pthread::try_mutex mutex) == pthread::MUTEX_WAS_UNAVAILABLE) print "Worked!\n";
        else								  print "Failed!\n";
	fi;
	#
	pthread::pthread_exit ();
    };

pthread = pthread::spawn_pthread  subthread_fn;

makelib::scripting_globals::sleep 1.11;

pthread::release_mutex mutex;

pthread::join_pthread pthread;




mutex = pthread::make_mutex ();
pthread::set_up_mutex (mutex, NULL);

fun subthread_fn ()
    =
    {   if ((pthread::try_mutex mutex) == pthread::ACQUIRED_MUTEX) print "Worked!\n";	pthread::release_mutex mutex;
        else							   print "Failed!\n";
	fi;

	#
	pthread::pthread_exit ();
    };

pthread = pthread::spawn_pthread  subthread_fn;


pthread::join_pthread pthread;




