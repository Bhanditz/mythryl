## prettyprinting-lib-unit-test.pkg

# Compiled by:
#     src/lib/test/unit-tests.lib

# Run by:
#     src/lib/test/all-unit-tests.pkg

stipulate
    package pp  =  standard_prettyprinter;				# standard_prettyprinter	is from   src/lib/prettyprint/big/src/standard-prettyprinter.pkg
herein

    package prettyprinting_lib_unit_test {
	#
	include unit_test;						# unit_test			is from   src/lib/src/unit-test.pkg
	include makelib::scripting_globals;

	name =  "src/lib/prettyprint/big/src/test/prettyprinting-lib-unit-test.pkg";

	fun prettyprint_to_string  linewidth  prettyprint_fn
	    = 
	    {   fun prettyprint_fn' pp ()				# We need this little adapter because  pp::prettyprint_to_string was written for fns like
		    =							#     prettyprint_footree pp footree; 
		    prettyprint_fn pp;					# but our prettyprint_fn doesn't have an arg like 'footree'.

		pp::prettyprint_to_string linewidth  prettyprint_fn'   ();
	    };

	fun test_basic_prettyprinter_operation  ()
	    =
	    {
		assert ("test"   ==   (prettyprint_to_string 10 (fn pp = { pp::string pp "test"; })));

		assert TRUE;
	    };


	fun run ()
	    =
	    {   printf "\nDoing %s:\n" name;   
		#
		test_basic_prettyprinter_operation  ();

# Next up: checking out actual patchfile modification under planfile control.

		summarize_unit_tests  name;
	    };
    };
end;
