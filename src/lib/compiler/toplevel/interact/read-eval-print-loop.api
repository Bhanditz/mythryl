## read-eval-print-loop.api 
 
# Compiled by:
#     src/lib/compiler/core.sublib



###        "The price of reliability is the pursuit of the utmost simplicity.
###         It is a price which the very rich find most hard to pay."
###
###                                                 -- E.W. Dijkstra



stipulate
    package fil =  file__premicrothread;				# file__premicrothread	is from   src/lib/std/src/posix/file--premicrothread.pkg
    package cs  =  compiler_state;					# compiler_state	is from   src/lib/compiler/toplevel/interact/compiler-state.pkg
    package ds  =  deep_syntax;						# deep_syntax		is from   src/lib/compiler/front/typer-stuff/deep-syntax/deep-syntax.pkg
    package sci =  sourcecode_info;					# sourcecode_info	is from   src/lib/compiler/front/basics/source/sourcecode-info.pkg
herein

    # This api is implemented in:
    #
    #     src/lib/compiler/toplevel/interact/read-eval-print-loop-g.pkg
    #
    api Read_Eval_Print_Loop {
	#
	exception CONTROL_C_SIGNAL; 

	read_eval_print_from_script
	    :
	    String -> Void;						# 'String' is "<stdin>" else filename for script.

	read_eval_print_from_user
	    :
	    Void -> Void;

	read_eval_print_from_stream
	    :
	    ( String,
	      fil::Input_Stream
	    )
	    ->
	    Void;

	with_error_handling
	    :
	    { treat_as_user: Bool }					# TRUE means to treat all exceptionns like usercode exceptions.
	    ->
	    { thunk:	Void -> Void,
	      flush:	Void -> Void,
	      fate:		Exception -> Void
	    }
	    ->
	    Void;

	compile_and_eval_string_in_given_compiler_state
	  :
	  {
	    sourcecode_info:		sci::Sourcecode_Info,
	    transform:			ds::Declaration -> ds::Declaration,
	    compiler_state_stack:	(cs::Compiler_State, List(cs::Compiler_State))
	  }
	  ->
	  { output:			String,
	    compiler_state_stack:	(cs::Compiler_State, List(cs::Compiler_State))
	  };

    };
end;

## Copyright 1996 by Bell Laboratories 
## Subsequent changes by Jeff Prothero Copyright (c) 2010-2015,
## released per terms of SMLNJ-COPYRIGHT.
