## old-queue.pkg
#
# Imperative fifos
#
# 2012-03-28 CrT:  It is a mess to have both this as threadkit-queue.   XXX SUCKO FIXME
#                  Maybe we should rename fifo -> queue
#                                         threadkit-queue -> rw_queue
#                  and then merge into threadkit-queue any functionality
#                  of queue.pkg currently missing and then drop queue.pkg
#                  as being one queue package too many.  Plus change the
#                  two apis to use the same names for the same operations.
#
# See also:
#     src/lib/src/fifo.pkg
#     src/lib/src/lib/thread-kit/src/core-thread-kit/threadkit-queue.pkg

# Compiled by:
#     src/lib/std/standard.lib




package old_queue : Old_Queue  {		# Old_Queue	is from   src/lib/src/old-queue.api

    Queue(X) = Ref( fifo::Fifo(X) );

    exception DEQUEUE = fifo::DEQUEUE;

    fun make_queue () = REF fifo::empty;

    fun clear q = (q := fifo::empty);

    fun enqueue (q, x) = q := (fifo::enqueue (*q, x));

    fun dequeue q = { 
          my (newq, x) = fifo::dequeue *q; 
          
            q := newq;
            x;
          };
  
    fun delete (q, prior) = (q := fifo::delete (*q, prior));
    fun head q = fifo::head *q;
    fun peek q = fifo::peek *q;
    fun is_empty q = fifo::is_empty *q;
    fun length q = fifo::length *q;
    fun contents q = fifo::contents *q;
    fun apply f q = fifo::apply f *q;
    fun map f q = REF (fifo::map f *q);
    fun fold_left  f b q = fifo::fold_left  f b *q;
    fun fold_right f b q = fifo::fold_right f b *q;

};


## COPYRIGHT (c) 1993 by AT&T Bell Laboratories.  See COPYRIGHT file for details.
## Subsequent changes by Jeff Prothero Copyright (c) 2010-2012,
## released under Gnu Public Licence version 3.
