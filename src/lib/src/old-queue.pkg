## old-queue.pkg
#
# Mutable queues. Nobody ever used this implementation,
# so it is being phased out in favor of rw-queue.pkg.
#
# 2012-03-28 CrT:  It is a mess to have both this as threadkit-queue.   XXX SUCKO FIXME
#                  Maybe we should rename fifo -> queue
#                                         threadkit-queue -> rw_queue   (DONE)
#                  and then merge into threadkit-queue any functionality
#                  of queue.pkg currently missing and then drop queue.pkg
#                  as being one queue package too many.  Plus change the
#                  two apis to use the same names for the same operations.
#
# See also:
#     src/lib/src/queue.pkg
#     src/lib/src/rw-queue.pkg

# Compiled by:
#     src/lib/std/standard.lib


stipulate
    package qu =  queue;						# queue		is from   src/lib/src/queue.pkg
herein

    package old_queue
          : Old_Queue							# Old_Queue	is from   src/lib/src/old-queue.api
    {
	Queue(X) = Ref( qu::Queue(X) );

	exception DEQUEUE = qu::DEQUEUE;

	fun make_queue () = REF qu::empty;

	fun clear q = (q := qu::empty);

	fun enqueue (q, x) = q := (qu::enqueue (*q, x));

	fun dequeue q = { 
	      my (newq, x) = qu::dequeue *q; 

		q := newq;
		x;
	      };

	fun delete (q, prior) = (q := qu::delete (*q, prior));
	fun head q = qu::head *q;
	fun peek q = qu::peek *q;
	fun is_empty q = qu::is_empty *q;
	fun length q = qu::length *q;
	fun contents q = qu::contents *q;
	fun apply f q = qu::apply f *q;
	fun map f q = REF (qu::map f *q);
	fun fold_left  f b q = qu::fold_left  f b *q;
	fun fold_right f b q = qu::fold_right f b *q;

    };
end;

## COPYRIGHT (c) 1993 by AT&T Bell Laboratories.  See COPYRIGHT file for details.
## Subsequent changes by Jeff Prothero Copyright (c) 2010-2012,
## released under Gnu Public Licence version 3.
