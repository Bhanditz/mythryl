<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>The Value Restriction</TITLE>
</HEAD>
<BODY >
<A HREF="my-Type_Constraint_Expressions.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Types.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><HR>
<H3 CLASS="subsection"><A NAME="htoc284">10.10.12</A>  The Value Restriction</H3><P>
<A NAME="section:ref:types:the-value-restriction"></A></P><P>In general the Mythryl compiler attempts to deduce the most 
general type for each function. Thus, for example, the function</P><PRE CLASS="verbatim">    fun swap (x,y) = (y,x);
</PRE><P>could logically be assigned any one of a literally infinite 
number of possible types such as </P><PRE CLASS="verbatim">    (Int, Int) -&gt; (Int, Int)
    (Float, Int) -&gt; (Int, Float)
    ((String, Int), Int) -&gt; (Int, (String, Int))
    (X, X) -&gt; (X, X)
    (X, Y) -&gt; (Y, X)
</PRE><P>Of these, the last is by far the most general; it allows the 
function to be used in the most possible contexts subject to 
correctness constraints. Thus, it is the most desirable from 
a code re-use point of view, in general. (In a particular case, 
of course, the programmer may intend that it be used only on 
more restricted types, and may explicitly declare that.)</P><P>There are some cases in which a most general type cannot be 
reliably induced by the compiler. For example, the problem 
of inferring a most general type for a set of mutually recursive 
functions is in general undecidable. (That is a precise mathematical 
term which in practice means "impossible".)</P><P>There are other cases in which it would be unsound to generalize 
the type of an expression. (By "generalize" we mean essentially 
"introduce type variables into".)</P><P>The rule univerally adopted in the functional programming world, 
and used by the Mythryl compiler, is called <I>the value restriction</I>, 
and says that type generalization is done only on expressions which 
involve no runtime side-effects &#X2014; expressions which are <I>values</I>.</P><P>In this sense, a function is a value &#X2014; it has no effect when defined, 
only when called. A number, or a string is also a value.</P><P>Since type generalization is rarely relevant to expressions like numbers 
or strings, in practice the value restriction may be taken as saying that 
only functions are type generalized &#X2014; and only functions which are 
not members of mutually recursive sets of functions.</P>

<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-Type_Constraint_Expressions.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Types.html"><IMG SRC="contents_motif.gif" ALT="Up"></A></BODY>
</HTML>
