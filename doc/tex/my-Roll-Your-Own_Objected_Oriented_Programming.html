<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>Roll-Your-Own Objected Oriented Programming</TITLE>
</HEAD>
<BODY >
<A HREF="my-Binary_Operators.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Delving_Deeper.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-Prefix__Postfix_and_Circumfix_Operators.html"><IMG SRC="next_motif.gif" ALT="Next"></A><HR>
<H3 CLASS="subsection"><A NAME="htoc78">5.3.13</A>  Roll-Your-Own Objected Oriented Programming</H3><P>
<A NAME="section:tut:delving-deeper:roll-your-own-oop"></A></P><P>There are about as many definitions of "object oriented programming" as there 
are object oriented languages, but implementation hiding and dynamic (runtime) 
binding of methods are central to most of them. We will discuss more elaborate 
approachs to object oriented programming in Mythryl 
<A HREF="my-Experimental_Object_Oriented_Programming_Support.html#section:tut:full-monte:experimental-object-oriented-programming-support">later</A>, later, but here is a very simple technique which is often enough for the job at hand. </P><P>The idea is to create some state which is shared by a set of functions but 
hidden from the rest of the program, and then to access those functions via 
a record of pointers to them.</P><P>For didactic clarity we will take as our example a simple counter which may 
be incremented, read or reset:</P><PRE CLASS="verbatim">    #!/usr/bin/mythryl

    fun make_counter ()
        =
        {
            # Create counter state, initialized to zero:
            #
            count = REF 0;

            # Define our methods
            #
            fun increment () =  count := *count + 1;
            fun get       () = *count;
            fun reset     () =  count := 0;

            # Create and return record of methods:
            #
            { increment, get, reset };
        };


    # Demonstration of counter use:
    print "\n";

    counter = make_counter ();      printf "State of counter after creation  d=%d\n" (counter.get ());
    counter.increment ();           printf "State of counter after increment d=%d\n" (counter.get ());
    counter.reset ();               printf "State of counter after reset     d=%d\n" (counter.get ());
</PRE><P>When run this script will print out:</P><PRE CLASS="verbatim">    linux$ ./my-script

    State of counter after creation  d=0
    State of counter after increment d=1
    State of counter after reset     d=0
</PRE><P>Things to note about this technique:</P><UL CLASS="itemize"><LI CLASS="li-itemize">
The only access to object state is via the exported methods.
</LI><LI CLASS="li-itemize">You may make as many counter objects as you please.
</LI><LI CLASS="li-itemize">The type of the counter depends only on the types and names of its methods, 
not on the internal implementation details. Consequently different kinds 
of counters may be used interchangably in external code so long as they 
support the same interface, which is to say, so long as their methods have 
the same names and same types.
</LI></UL><P>For an industrial strength example of this technique in action see the library 
graph implementation in 
<A HREF="my-src_lib_graph_oop-digraph_api.html#src/lib/graph/oop-digraph.api">src/lib/graph/oop-digraph.api</A> and <A HREF="my-src_lib_graph_oop-digraph_pkg.html#src/lib/graph/oop-digraph.pkg">src/lib/graph/oop-digraph.pkg</A>.</P>
<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-Binary_Operators.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Delving_Deeper.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-Prefix__Postfix_and_Circumfix_Operators.html"><IMG SRC="next_motif.gif" ALT="Next"></A></BODY>
</HTML>
