<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>Red-Black Trees: File Stat Example</TITLE>
</HEAD>
<BODY >
<A HREF="my-Red-Black_Trees__Union_and_Intersection.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Balanced_Binary_Trees.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-Red-Black_Trees__Sets_and_the_Set_Api.html"><IMG SRC="next_motif.gif" ALT="Next"></A><HR>
<H4 CLASS="subsubsection">Red-Black Trees: File Stat Example</H4><P>There are a few more functions in the <TT>Map</TT> API, but the above 
should be more than enough to get you started.</P><P>To close out this section, here is a more realistic example: We 
will get a list of all the files in the current directory, then 
run <TT>stat</TT> on each to get information such as its size, enter 
the stat results into a map keyed by the filename, and finally 
extract a useful result from the resulting map:</P><PRE CLASS="verbatim">    #!/usr/bin/mythryl

    package map = string_map;

    stat_map = REF (map::empty: map::Map( posix::stat::Stat ));

    foreach (dir::files ".")
            (\\ filename
                =
                stat_map := map::set (*stat_map, filename, stat filename)
            );

    my (file1, _) =  the (map::first_keyval_else_null *stat_map);

    printf
        "First file is named '%s' and has size %d.\n"
        file1
        (the (map::get (*stat_map, file1))).size;
</PRE><P>When run this should produce a result something like
</P><PRE CLASS="verbatim">    linux$ ./my-script
    First file is named '/pub/home/cynbe/mythryl7.110.58/Configure' and has size 328.
</PRE><P>The experienced Mythryl programmer tends to dislike avoidable use 
of side-effects, hence might write the above script as:</P><PRE CLASS="verbatim">    #!/usr/bin/mythryl

    package map = string_map;

    filenames = dir::files ".";

    file1 = head filenames;

    stat_map
        =
        fold_backward
            (\\ (filename, stat_map) = map::set (stat_map, filename, stat filename))
            (map::empty: map::Map( posix::stat::Stat ))
            filenames;

    printf
        "First file is named '%s' and has size %d.\n"
        file1
        (the (map::get (stat_map, file1))).size;
</PRE><P>The difference is mostly a matter of taste. 
The result when run will be identical either way:</P><PRE CLASS="verbatim">    linux$ ./my-script
    First file is named '/pub/home/cynbe/mythryl7.110.58/Configure' and has size 328.
</PRE>

<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-Red-Black_Trees__Union_and_Intersection.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Balanced_Binary_Trees.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-Red-Black_Trees__Sets_and_the_Set_Api.html"><IMG SRC="next_motif.gif" ALT="Next"></A></BODY>
</HTML>
