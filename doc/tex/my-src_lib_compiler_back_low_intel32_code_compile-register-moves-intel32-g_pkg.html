<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>src/lib/compiler/back/low/intel32/code/compile-register-moves-intel32-g.pkg</TITLE>
</HEAD>
<BODY >
<A HREF="my-src_lib_compiler_back_low_intel32_ccalls_ccalls-intel32-per-unix-system-v-abi-g_pkg.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Codebase__pkg_Files.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-src_lib_compiler_back_low_intel32_code_instruction-frequency-properties-intel32-g_pkg.html"><IMG SRC="next_motif.gif" ALT="Next"></A><HR>
<H3 CLASS="subsection"><A NAME="htoc2138">15.4.250</A>  src/lib/compiler/back/low/intel32/code/compile-register-moves-intel32-g.pkg</H3><P>
<A NAME="src/lib/compiler/back/low/intel32/code/compile-register-moves-intel32-g.pkg"></A>
<CODE>##&nbsp;compile-register-moves-intel32-g.pkg</CODE><BR>
<CODE>#</CODE><BR><BR>
<CODE>#&nbsp;Compiled&nbsp;by:</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_back_low_intel32_backend-intel32_lib.html#src/lib/compiler/back/low/intel32/backend-intel32.lib"><TT>src/lib/compiler/back/low/intel32/backend-intel32.lib</TT></A><BR><BR><BR><BR><CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"I&nbsp;think&nbsp;we&nbsp;need&nbsp;someone&nbsp;in&nbsp;a</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;responsible&nbsp;political&nbsp;position</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;have&nbsp;the&nbsp;courage&nbsp;to&nbsp;say,</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Let's&nbsp;terminate&nbsp;human&nbsp;spaceflight.'"</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--James&nbsp;Van&nbsp;Allen&nbsp;</CODE><BR><BR><BR>
<CODE>#&nbsp;Our&nbsp;generic&nbsp;is&nbsp;compiletime-invoked&nbsp;from:</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_back_low_main_intel32_backend-lowhalf-intel32-g_pkg.html#src/lib/compiler/back/low/main/intel32/backend-lowhalf-intel32-g.pkg"><TT>src/lib/compiler/back/low/main/intel32/backend-lowhalf-intel32-g.pkg</TT></A><BR><BR><CODE>stipulate</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;rkj&nbsp;=&nbsp;&nbsp;registerkinds_junk;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;registerkinds_junk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_back_low_code_registerkinds-junk_pkg.html#src/lib/compiler/back/low/code/registerkinds-junk.pkg"><TT>src/lib/compiler/back/low/code/registerkinds-junk.pkg</TT></A><BR><CODE>herein</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;generic&nbsp;package&nbsp;&nbsp;&nbsp;compile_register_moves_intel32_g&nbsp;&nbsp;&nbsp;(</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;================================</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcf:&nbsp;&nbsp;Machcode_Intel32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Machcode_Intel32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_back_low_intel32_code_machcode-intel32_codemade_api.html#src/lib/compiler/back/low/intel32/code/machcode-intel32.codemade.api"><TT>src/lib/compiler/back/low/intel32/code/machcode-intel32.codemade.api</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;(weak)&nbsp;Compile_Register_Moves_Intel32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compile_Register_Moves_Intel32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_back_low_intel32_code_compile-register-moves-intel32_api.html#src/lib/compiler/back/low/intel32/code/compile-register-moves-intel32.api"><TT>src/lib/compiler/back/low/intel32/code/compile-register-moves-intel32.api</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;{</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Export&nbsp;to&nbsp;client&nbsp;packages:</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;mcf&nbsp;=&nbsp;mcf;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stipulate</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;crm</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compile_register_moves_g&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compile_register_moves_g&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_back_low_code_compile-register-moves-g_pkg.html#src/lib/compiler/back/low/code/compile-register-moves-g.pkg"><TT>src/lib/compiler/back/low/code/compile-register-moves-g.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;"mcf"&nbsp;==&nbsp;"machcode_form"&nbsp;(abstract&nbsp;machine&nbsp;code).</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;herein</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parallel_Register_Moves</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;tmp:&nbsp;&nbsp;Null_Or(&nbsp;mcf::Operand&nbsp;),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Temporary&nbsp;register&nbsp;if&nbsp;needed.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst:&nbsp;&nbsp;List(&nbsp;rkj::Codetemp_Info&nbsp;),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Move&nbsp;values&nbsp;in&nbsp;these&nbsp;registers...</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src:&nbsp;&nbsp;List(&nbsp;rkj::Codetemp_Info&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;...&nbsp;into&nbsp;these&nbsp;registers.&nbsp;Lists&nbsp;must&nbsp;be&nbsp;same&nbsp;length.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exception&nbsp;FOO;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compile_int_register_moves</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crm::compile_int_register_moves</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move_instruction&nbsp;=&gt;&nbsp;&nbsp;&nbsp;\\&nbsp;{&nbsp;dst,&nbsp;src&nbsp;}&nbsp;=&nbsp;[mcf::move&nbsp;{&nbsp;mv_op=&gt;mcf::MOVL,&nbsp;src,&nbsp;dst&nbsp;}&nbsp;],</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;&nbsp;mcf::DIRECT</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;These&nbsp;assume&nbsp;that&nbsp;the&nbsp;''registers''</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;are&nbsp;mapped&nbsp;onto&nbsp;the&nbsp;memory.</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Note,&nbsp;this&nbsp;only&nbsp;works&nbsp;with</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;double&nbsp;precision&nbsp;floating&nbsp;point:</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shufflefp_normal_and_slow</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crm::compile_int_register_moves</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move_instruction&nbsp;=&gt;&nbsp;&nbsp;&nbsp;\\&nbsp;{&nbsp;dst,&nbsp;src&nbsp;}&nbsp;=&nbsp;[mcf::fldl&nbsp;src,&nbsp;mcf::fstpl&nbsp;dst],</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;&nbsp;mcf::FDIRECT</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;This&nbsp;version&nbsp;makes&nbsp;use&nbsp;of&nbsp;the&nbsp;intel32</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;floating&nbsp;point&nbsp;stack&nbsp;for&nbsp;hardware</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;renaming:</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;shufflefp_normal&nbsp;{&nbsp;tmp,&nbsp;src,&nbsp;dst&nbsp;}</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;&nbsp;length&nbsp;src;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(n&nbsp;&lt;=&nbsp;7)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;gen&nbsp;(s&nbsp;!&nbsp;ss,&nbsp;d&nbsp;!&nbsp;ds,&nbsp;pushes,&nbsp;pops)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(rkj::codetemps_are_same_color&nbsp;(s,&nbsp;d))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen&nbsp;(ss,&nbsp;ds,&nbsp;pushes,&nbsp;pops);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen&nbsp;(ss,&nbsp;ds,&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcf::fldl&nbsp;&nbsp;(mcf::FDIRECT&nbsp;s)&nbsp;!&nbsp;pushes,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mcf::fstpl&nbsp;(mcf::FDIRECT&nbsp;d)&nbsp;!&nbsp;pops</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen&nbsp;(_,&nbsp;_,&nbsp;pushes,&nbsp;pops)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list::reverse_and_prepend&nbsp;(pushes,&nbsp;pops);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen&nbsp;(src,&nbsp;dst,&nbsp;[],&nbsp;[]);&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shufflefp_normal_and_slow&nbsp;{&nbsp;tmp,&nbsp;src,&nbsp;dst&nbsp;};</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;These&nbsp;assume&nbsp;that&nbsp;the&nbsp;''registers''&nbsp;are&nbsp;mapped&nbsp;onto&nbsp;the&nbsp;pseudo&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;%fpr&nbsp;register.&nbsp;&nbsp;Only&nbsp;works&nbsp;with&nbsp;double&nbsp;precision&nbsp;floating&nbsp;point&nbsp;for&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;now...</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shufflefp_fast</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crm::compile_int_register_moves</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move_instruction&nbsp;=&gt;&nbsp;&nbsp;&nbsp;\\&nbsp;{&nbsp;dst,&nbsp;src&nbsp;}&nbsp;=&nbsp;[mcf::fmove&nbsp;{&nbsp;fsize&nbsp;=&gt;&nbsp;mcf::FP64,&nbsp;&nbsp;&nbsp;src,&nbsp;dst&nbsp;}&nbsp;],</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;&nbsp;mcf::FPR</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;compile_float_register_moves&nbsp;(x&nbsp;as&nbsp;{&nbsp;tmp=&gt;THE&nbsp;(mcf::FPR&nbsp;_),&nbsp;...&nbsp;}&nbsp;)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shufflefp_fast&nbsp;x;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compile_float_register_moves&nbsp;x</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shufflefp_normal&nbsp;x;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR>
<CODE>end;</CODE><BR><BR>
<CODE>#&nbsp;NOTE&nbsp;on&nbsp;xchg&nbsp;on&nbsp;the&nbsp;intel32</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;From&nbsp;Allen&nbsp;Leung:</CODE><BR>
<CODE>#&nbsp;Here's&nbsp;why&nbsp;I&nbsp;didn't&nbsp;use&nbsp;xchg:&nbsp;</CODE><BR>
<CODE>#&nbsp;</CODE><BR>
<CODE>#&nbsp;o&nbsp;&nbsp;According&nbsp;to&nbsp;the&nbsp;optimization&nbsp;guide&nbsp;xchg&nbsp;mem,&nbsp;reg&nbsp;is&nbsp;complex,</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;cannot&nbsp;be&nbsp;pipelined&nbsp;or&nbsp;paired&nbsp;at&nbsp;all.&nbsp;xchg&nbsp;reg,&nbsp;reg&nbsp;requires&nbsp;3&nbsp;uops.</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;contrast,&nbsp;mov&nbsp;mem,&nbsp;reg&nbsp;requires&nbsp;1&nbsp;or&nbsp;2&nbsp;uops.&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;So&nbsp;xchgs&nbsp;loses&nbsp;out,&nbsp;at&nbsp;least&nbsp;on&nbsp;paper.&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;[I&nbsp;haven't&nbsp;done&nbsp;any&nbsp;measurements&nbsp;though]&nbsp;</CODE><BR>
<CODE>#&nbsp;</CODE><BR>
<CODE>#&nbsp;o&nbsp;&nbsp;Secondly,&nbsp;unlike&nbsp;other&nbsp;architectures,&nbsp;parallel&nbsp;copies&nbsp;are&nbsp;split&nbsp;</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;individual&nbsp;copies&nbsp;during&nbsp;instruction&nbsp;selection.&nbsp;&nbsp;Here's&nbsp;why</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;did&nbsp;this:&nbsp;&nbsp;I&nbsp;found&nbsp;that&nbsp;more&nbsp;copies&nbsp;are&nbsp;retained&nbsp;and&nbsp;more&nbsp;spills&nbsp;</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;are&nbsp;generated&nbsp;when&nbsp;keeping&nbsp;the&nbsp;parallel&nbsp;copies.&nbsp;&nbsp;&nbsp;My&nbsp;guess&nbsp;on&nbsp;this&nbsp;is&nbsp;</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;the&nbsp;copy&nbsp;temporary&nbsp;for&nbsp;parallel&nbsp;copies&nbsp;create&nbsp;addition&nbsp;</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;interferences&nbsp;[even&nbsp;when&nbsp;they&nbsp;are&nbsp;not&nbsp;needed.]&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;not&nbsp;a&nbsp;problem&nbsp;on&nbsp;RISC&nbsp;machines,&nbsp;because&nbsp;of&nbsp;plentiful&nbsp;registers.</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;o&nbsp;&nbsp;Spilling&nbsp;of&nbsp;parallel&nbsp;copies&nbsp;is&nbsp;also&nbsp;a&nbsp;very&nbsp;complex&nbsp;business&nbsp;when</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;memory&nbsp;coalescing&nbsp;is&nbsp;turned&nbsp;on.&nbsp;&nbsp;I&nbsp;think&nbsp;I&nbsp;have&nbsp;implemented&nbsp;a&nbsp;solution</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;this,&nbsp;but&nbsp;not&nbsp;using&nbsp;parallel&nbsp;copies&nbsp;keep&nbsp;life&nbsp;simple.&nbsp;&nbsp;&nbsp;This&nbsp;problem</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;could&nbsp;be&nbsp;simpler&nbsp;with&nbsp;xchg...but&nbsp;I&nbsp;haven't&nbsp;thought&nbsp;about&nbsp;it&nbsp;much.</CODE><BR>
<CODE>#&nbsp;</CODE><BR>
<CODE>#&nbsp;From&nbsp;Fermin&nbsp;Reig:</CODE><BR>
<CODE>#&nbsp;In&nbsp;the&nbsp;java@gcc.gnu.org,&nbsp;GC&nbsp;&nbsp;mailing&nbsp;lists&nbsp;there's&nbsp;been&nbsp;a&nbsp;discussion&nbsp;about</CODE><BR>
<CODE>#&nbsp;the&nbsp;costs&nbsp;of&nbsp;xcgh.&nbsp;Here's&nbsp;some&nbsp;extracts&nbsp;of&nbsp;it:</CODE><BR>
<CODE>#&nbsp;</CODE><BR>
<CODE>#&nbsp;----------------</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;From:&nbsp;Emery&nbsp;Berger&nbsp;[mailto:&nbsp;emery@cs.utexas.edu]</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;http://developer.intel.com/design/pentium4/manuals/24547203::pdf</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;See&nbsp;Chapter&nbsp;7.1.&nbsp;"For&nbsp;the&nbsp;P6&nbsp;family&nbsp;processors,&nbsp;locked&nbsp;</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;operations&nbsp;serialize</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;all&nbsp;outstanding&nbsp;load&nbsp;and&nbsp;store&nbsp;operations&nbsp;(that&nbsp;is,&nbsp;wait&nbsp;for&nbsp;them&nbsp;to</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;complete).&nbsp;This&nbsp;rule&nbsp;is&nbsp;also&nbsp;TRUE&nbsp;for&nbsp;the&nbsp;Pentium&nbsp;4&nbsp;</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;processor,&nbsp;with&nbsp;one</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;exception:&nbsp;load&nbsp;operations&nbsp;that&nbsp;reference&nbsp;weakly&nbsp;ordered&nbsp;</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;memory&nbsp;types&nbsp;(such</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;as&nbsp;the&nbsp;WC&nbsp;memory&nbsp;type)&nbsp;may&nbsp;not&nbsp;be&nbsp;serialized.&nbsp;"</CODE><BR>
<CODE>#&nbsp;&gt;&nbsp;</CODE><BR>
<CODE>#&nbsp;-----------------</CODE><BR>
<CODE>#&nbsp;I&nbsp;just&nbsp;tried&nbsp;this&nbsp;on&nbsp;a&nbsp;500&nbsp;MHz&nbsp;Pentium&nbsp;III.&nbsp;&nbsp;I&nbsp;get&nbsp;about&nbsp;23&nbsp;cycles&nbsp;for</CODE><BR>
<CODE>#&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;lock;&nbsp;cmpxchg</CODE><BR>
<CODE>#&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;:</CODE><BR>
<CODE>#&nbsp;and&nbsp;about&nbsp;19&nbsp;or&nbsp;20&nbsp;cycles&nbsp;for&nbsp;xchg&nbsp;(which&nbsp;has&nbsp;an&nbsp;implicit&nbsp;lock&nbsp;prefix).</CODE><BR>
<CODE>#&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;I&nbsp;got&nbsp;consistent&nbsp;results&nbsp;by&nbsp;timing&nbsp;a&nbsp;loop&nbsp;and&nbsp;by&nbsp;looking&nbsp;at&nbsp;an&nbsp;instruction</CODE><BR>
<CODE>#&nbsp;level&nbsp;profile.&nbsp;&nbsp;Putting&nbsp;other&nbsp;stuff&nbsp;in&nbsp;the&nbsp;loop&nbsp;didn't&nbsp;seem&nbsp;to&nbsp;affect&nbsp;the</CODE><BR>
<CODE>#&nbsp;time&nbsp;taken&nbsp;by&nbsp;xchg&nbsp;much.&nbsp;&nbsp;Here's&nbsp;the&nbsp;code&nbsp;in&nbsp;case&nbsp;someone&nbsp;else&nbsp;wants&nbsp;to&nbsp;try.</CODE><BR>
<CODE>#&nbsp;(This&nbsp;requires&nbsp;Linux/gcc)</CODE><BR>
<CODE>#&nbsp;-------------------</CODE><BR>
<CODE>#&nbsp;Chris&nbsp;Dodd&nbsp;pointed&nbsp;out&nbsp;on&nbsp;the&nbsp;GC&nbsp;mailing&nbsp;list&nbsp;that&nbsp;on&nbsp;recent&nbsp;Intel32&nbsp;(x86)</CODE><BR>
<CODE>#&nbsp;processors:</CODE><BR>
<CODE>#&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;-&nbsp;cmpxchg&nbsp;without&nbsp;a&nbsp;lock&nbsp;prefix&nbsp;is&nbsp;much&nbsp;faster&nbsp;(roughly&nbsp;3x&nbsp;or&nbsp;close&nbsp;to&nbsp;15</CODE><BR>
<CODE>#&nbsp;cycles&nbsp;by&nbsp;my&nbsp;measurements)&nbsp;than&nbsp;either&nbsp;xchg&nbsp;(implied&nbsp;lock&nbsp;prefix)&nbsp;or&nbsp;lock;</CODE><BR>
<CODE>#&nbsp;cmpxchg&nbsp;.</CODE><BR>
<CODE>#&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;-&nbsp;cmpxchg&nbsp;without&nbsp;the&nbsp;lock&nbsp;prefix&nbsp;is&nbsp;atomic&nbsp;on&nbsp;uniprocessors,&nbsp;i.e.&nbsp;it's&nbsp;not</CODE><BR>
<CODE>#&nbsp;interruptable.</CODE><BR>
<CODE>#&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;As&nbsp;far&nbsp;as&nbsp;I&nbsp;can&nbsp;tell,&nbsp;none&nbsp;of&nbsp;the&nbsp;GNU&nbsp;libraries&nbsp;currently&nbsp;take&nbsp;advantage&nbsp;of</CODE><BR>
<CODE>#&nbsp;this&nbsp;fact.&nbsp;&nbsp;Should&nbsp;they?</CODE><BR>
<CODE>#&nbsp;&nbsp;</CODE><BR>
<CODE>#&nbsp;This&nbsp;argues,&nbsp;for&nbsp;example,&nbsp;that&nbsp;I&nbsp;could&nbsp;get&nbsp;noticable&nbsp;additional&nbsp;speedup&nbsp;from</CODE><BR>
<CODE>#&nbsp;Java&nbsp;hash&nbsp;synchronization&nbsp;on&nbsp;Intel32&nbsp;by&nbsp;overwriting&nbsp;a&nbsp;few&nbsp;strategic&nbsp;"lock"</CODE><BR>
<CODE>#&nbsp;prefixes&nbsp;with&nbsp;"nop"s&nbsp;when&nbsp;I&nbsp;notice&nbsp;that&nbsp;there's&nbsp;only&nbsp;one&nbsp;processor</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;From&nbsp;John&nbsp;Reppy:</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;Disregard&nbsp;what&nbsp;I&nbsp;said.&nbsp;&nbsp;The&nbsp;xchg&nbsp;instruction&nbsp;has&nbsp;an&nbsp;implicit&nbsp;lock&nbsp;prefix,</CODE><BR>
<CODE>#&nbsp;so&nbsp;it&nbsp;is&nbsp;not&nbsp;useful&nbsp;for&nbsp;normal&nbsp;programming&nbsp;tasks.</CODE><BR>
</P>

<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-src_lib_compiler_back_low_intel32_ccalls_ccalls-intel32-per-unix-system-v-abi-g_pkg.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Codebase__pkg_Files.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-src_lib_compiler_back_low_intel32_code_instruction-frequency-properties-intel32-g_pkg.html"><IMG SRC="next_motif.gif" ALT="Next"></A></BODY>
</HTML>
