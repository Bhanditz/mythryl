<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>Filter a text file</TITLE>
</HEAD>
<BODY >
<A HREF="my-Append_text_to_a_file.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Recipes.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-Delete_a_file.html"><IMG SRC="next_motif.gif" ALT="Next"></A><HR>
<H3 CLASS="subsection"><A NAME="htoc163">5.5.48</A>  Filter a text file</H3><P>A frequent requirement is to read a text file, make line by line 
changes to its contents, and then write the result back.</P><P>Suppose you want to convert the contents of file <TT>foo.txt</TT> 
to upper case. Here is one solution:</P><PRE CLASS="verbatim">    filename = "foo.txt";
    lines    = file::as_lines filename;
    lines    = map string::to_upper lines;
    file::from_lines filename lines; 
</PRE><P>If you suffer from One-Liner Disease, you might write this as</P><PRE CLASS="verbatim">    file::from_lines "foo.txt" (map string::to_upper (file::as_lines "foo.txt"));
</PRE><P>Or if you enjoy writing C in Mythryl, you might do</P><PRE CLASS="verbatim">    #!/usr/bin/mythryl
    fd_in  = file::open_for_read "foo.txt";
    fd_out = file::open       "foo.txt.new";
    for (line = file::read_line fd_in;
         line != NULL;
         line = file::read_line fd_in
    ){
        line = string::to_upper (the line);
        file::write (fd_out, line);
    };
    file::close_input fd_in;
    file::close       fd_out;
    winix__premicrothread::file::remove_file "foo.txt";
    winix__premicrothread::file::rename_file { from =&gt; "foo.txt.new", to =&gt; "foo.txt" };
    exit 0;
</PRE><P>As Larry Wall says, any code is ok if it gets the job done before you get fired!</P><P>For more ideas on transforming lines as you filter a file, see the section on 
<A HREF="my-Regular_expressions.html#section:tut:recipe:regular-expressions">regular expression recipes</A>.</P>

<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-Append_text_to_a_file.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Recipes.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-Delete_a_file.html"><IMG SRC="next_motif.gif" ALT="Next"></A></BODY>
</HTML>
