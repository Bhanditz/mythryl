<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>winix_file_io_mutex</TITLE>
</HEAD>
<BODY >
<A HREF="my-winix_data_file_io_driver_for_posix__premicrothread.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Less_Frequently_Used_Packages.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-winix_io.html"><IMG SRC="next_motif.gif" ALT="Next"></A><HR>
<H3 CLASS="subsection"><A NAME="htoc593">13.4.186</A>  winix_file_io_mutex</H3><P>						<A NAME="@pkg257"></A>
<A NAME="pkg:winix_file_io_mutex"></A>

The standard library <TT>winix_file_io_mutex</TT> package exports a mutex ("mutual exclusion") 
for use by posix-threaded code. The <TT>standard.lib</TT> cross-platform "winix" file I/O logic 
is not currently threadsafe, so parallel code should protect calls to winix functions (such 
as those in the <TT>file</TT> package) via logic like:</P><PRE CLASS="verbatim">    stipulate
        package hth =  hostthread;
        package mtx =  winix_file_io_mutex;
    herein
    
        package foo {
              #
              # Define a hostthread-safe function to output lines:
              #
              fun pline  line_fn
                  =
                  hth::with_mutex_do  mtx::mutex  {.
                      #
                      line =  line_fn ()  +  "\n";
                      #
                      file::write (file::stdout, line );
                 };
    
            &lt; omitted code &gt;

                  pline . { sprintf "Fiddle %d  faddle %d" foo bar;  };
                
            &lt; omitted code &gt;
          };
    end;
</PRE><P>The <TT>winix_file_io_mutex</TT> package source code is in <A HREF="my-src_lib_std_src_io_winix-file-io-mutex_pkg.html#src/lib/std/src/io/winix-file-io-mutex.pkg">src/lib/std/src/io/winix-file-io-mutex.pkg</A>.</P><P>See also: <A HREF="my-file.html#pkg:file">file</A>.</P><P>See also: <A HREF="my-hostthread.html#pkg:hostthread">hostthread</A>.</P><P><FONT SIZE=1><I>The above information is manually maintained and may contain errors.</I></FONT>
</P><PRE CLASS="verbatim">api {
    mutex : hostthread::Mutex;};
</PRE>

<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-winix_data_file_io_driver_for_posix__premicrothread.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Less_Frequently_Used_Packages.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-winix_io.html"><IMG SRC="next_motif.gif" ALT="Next"></A></BODY>
</HTML>
