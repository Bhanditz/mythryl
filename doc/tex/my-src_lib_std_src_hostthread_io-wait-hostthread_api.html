<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>src/lib/std/src/hostthread/io-wait-hostthread.api</TITLE>
</HEAD>
<BODY >
<A HREF="my-src_lib_std_src_hostthread_io-bound-task-hostthreads_api.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Codebase__api_Files.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-src_lib_std_src_hostthread_template-hostthread_api.html"><IMG SRC="next_motif.gif" ALT="Next"></A><HR>
<H3 CLASS="subsection"><A NAME="htoc1553">15.3.477</A>  src/lib/std/src/hostthread/io-wait-hostthread.api</H3><P>
<A NAME="src/lib/std/src/hostthread/io-wait-hostthread.api"></A>
<CODE>#&nbsp;io-wait-hostthread.api</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;Interface&nbsp;to&nbsp;a&nbsp;server&nbsp;hostthread&nbsp;designed&nbsp;to&nbsp;basically&nbsp;just</CODE><BR>
<CODE>#&nbsp;sit&nbsp;in&nbsp;a&nbsp;loop&nbsp;doing&nbsp;C&nbsp;select()&nbsp;over&nbsp;and&nbsp;over&nbsp;on&nbsp;whatever</CODE><BR>
<CODE>#&nbsp;file/pipe/socket&nbsp;descriptors&nbsp;are&nbsp;of&nbsp;current&nbsp;interest.</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;Our&nbsp;main&nbsp;purpose&nbsp;is&nbsp;to&nbsp;offload&nbsp;I/O&nbsp;blocking&nbsp;from&nbsp;the</CODE><BR>
<CODE>#&nbsp;main&nbsp;threadkit&nbsp;hostthread&nbsp;so&nbsp;that&nbsp;it&nbsp;can&nbsp;run&nbsp;full&nbsp;speed&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Threadkit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_src_lib_thread-kit_src_core-thread-kit_threadkit_api.html#src/lib/src/lib/thread-kit/src/core-thread-kit/threadkit.api"><TT>src/lib/src/lib/thread-kit/src/core-thread-kit/threadkit.api</TT></A><BR><CODE>#&nbsp;while&nbsp;we&nbsp;sit&nbsp;around&nbsp;waiting&nbsp;for&nbsp;network&nbsp;packets&nbsp;to&nbsp;arrive.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;threadkit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_src_lib_thread-kit_src_core-thread-kit_threadkit_pkg.html#src/lib/src/lib/thread-kit/src/core-thread-kit/threadkit.pkg"><TT>src/lib/src/lib/thread-kit/src/core-thread-kit/threadkit.pkg</TT></A><BR><CODE>#</CODE><BR>
<CODE>#&nbsp;A&nbsp;secondary&nbsp;purpose&nbsp;of&nbsp;io_wait_hostthread&nbsp;is&nbsp;to&nbsp;provide&nbsp;the</CODE><BR>
<CODE>#&nbsp;clock&nbsp;threadkit&nbsp;needs&nbsp;to&nbsp;drive&nbsp;its&nbsp;pre-emptive&nbsp;timeslicing.</CODE><BR>
<CODE>#&nbsp;Reppy's&nbsp;original&nbsp;CML&nbsp;implementation&nbsp;uses&nbsp;SIGALRM&nbsp;for&nbsp;this,</CODE><BR>
<CODE>#&nbsp;but&nbsp;this&nbsp;has&nbsp;two&nbsp;critical&nbsp;disadvantages:</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;&nbsp;o&nbsp;&nbsp;SIGALRM&nbsp;is&nbsp;a&nbsp;bottleneck&nbsp;resource&nbsp;which&nbsp;everyone&nbsp;wants</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;control.</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;&nbsp;o&nbsp;&nbsp;Worse,&nbsp;SIGALRM&nbsp;interrupts&nbsp;"slow"&nbsp;system&nbsp;calls,&nbsp;causing</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;them&nbsp;to&nbsp;return&nbsp;EINTR&nbsp;instead&nbsp;of&nbsp;a&nbsp;useful&nbsp;result,&nbsp;requiring</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;relevant&nbsp;C&nbsp;code&nbsp;to&nbsp;re-try.&nbsp;&nbsp;We&nbsp;can&nbsp;ensure&nbsp;that&nbsp;our&nbsp;own</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;support&nbsp;code&nbsp;does&nbsp;this,&nbsp;but&nbsp;one&nbsp;call&nbsp;--&nbsp;connect()&nbsp;--</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*cannot*&nbsp;be&nbsp;retried,&nbsp;and&nbsp;we&nbsp;cannot&nbsp;be&nbsp;sure&nbsp;that&nbsp;all&nbsp;C</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libraries&nbsp;linked&nbsp;into&nbsp;the&nbsp;runtime&nbsp;will&nbsp;retry&nbsp;properly</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;EINTR.&nbsp;(In&nbsp;fact,&nbsp;I'd&nbsp;bet&nbsp;good&nbsp;odds&nbsp;that&nbsp;some&nbsp;will&nbsp;not.)</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;By&nbsp;having&nbsp;our&nbsp;select()&nbsp;time&nbsp;out&nbsp;regularly&nbsp;and&nbsp;generate</CODE><BR>
<CODE>#&nbsp;a&nbsp;timeslice&nbsp;clock&nbsp;for&nbsp;threadkit&nbsp;based&nbsp;on&nbsp;those&nbsp;timeouts</CODE><BR>
<CODE>#&nbsp;we&nbsp;almost&nbsp;completely&nbsp;avoid&nbsp;both&nbsp;of&nbsp;those&nbsp;problems.</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;("Almost"&nbsp;because,&nbsp;for&nbsp;example,&nbsp;SIGCHLD&nbsp;can&nbsp;still&nbsp;interrupt</CODE><BR>
<CODE>#&nbsp;"slow"&nbsp;syscalls.&nbsp;&nbsp;But&nbsp;that&nbsp;will&nbsp;usually&nbsp;be&nbsp;very&nbsp;very&nbsp;rare,</CODE><BR>
<CODE>#&nbsp;since&nbsp;child&nbsp;process&nbsp;deaths&nbsp;are&nbsp;usually&nbsp;rare&nbsp;and&nbsp;for&nbsp;one</CODE><BR>
<CODE>#&nbsp;to&nbsp;hit&nbsp;during&nbsp;a&nbsp;"slow"&nbsp;syscall&nbsp;lacking&nbsp;proper&nbsp;retry-on-EINTR</CODE><BR>
<CODE>#&nbsp;will&nbsp;be&nbsp;doubly&nbsp;rare.)</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;See&nbsp;also:</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_std_src_hostthread_cpu-bound-task-hostthreads_api.html#src/lib/std/src/hostthread/cpu-bound-task-hostthreads.api"><TT>src/lib/std/src/hostthread/cpu-bound-task-hostthreads.api</TT></A><BR><CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_std_src_hostthread_io-bound-task-hostthreads_api.html#src/lib/std/src/hostthread/io-bound-task-hostthreads.api"><TT>src/lib/std/src/hostthread/io-bound-task-hostthreads.api</TT></A><BR><BR><CODE>#&nbsp;Compiled&nbsp;by:</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_std_standard_lib.html#src/lib/std/standard.lib"><TT>src/lib/std/standard.lib</TT></A><BR><BR><CODE>stipulate</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;package&nbsp;hth&nbsp;=&nbsp;&nbsp;hostthread;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;hostthread&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_std_src_hostthread_pkg.html#src/lib/std/src/hostthread.pkg"><TT>src/lib/std/src/hostthread.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;tim&nbsp;=&nbsp;&nbsp;time;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_std_time_pkg.html#src/lib/std/time.pkg"><TT>src/lib/std/time.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;wio&nbsp;=&nbsp;&nbsp;winix__premicrothread::io;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;winix__premicrothread::io&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_std_src_posix_winix-io__X2013_premicrothread_pkg.html#src/lib/std/src/posix/winix-io--premicrothread.pkg"><TT>src/lib/std/src/posix/winix-io--premicrothread.pkg</TT></A><BR><CODE>herein</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;This&nbsp;api&nbsp;is&nbsp;implemented&nbsp;in:</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_std_src_hostthread_io-wait-hostthread_pkg.html#src/lib/std/src/hostthread/io-wait-hostthread.pkg"><TT>src/lib/std/src/hostthread/io-wait-hostthread.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;api&nbsp;Io_Wait_Hostthread&nbsp;{</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_running:&nbsp;Void&nbsp;-&gt;&nbsp;Bool;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Returns&nbsp;TRUE&nbsp;iff&nbsp;the&nbsp;server&nbsp;hostthread&nbsp;is&nbsp;running.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_server_hostthread_if_not_running:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;-&gt;&nbsp;Void;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Clear&nbsp;the&nbsp;internal&nbsp;wait-request&nbsp;list&nbsp;and&nbsp;start&nbsp;the&nbsp;select()&nbsp;hostthread&nbsp;running.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;This&nbsp;is&nbsp;a&nbsp;no-op&nbsp;if&nbsp;it&nbsp;is&nbsp;already&nbsp;running.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;String&nbsp;arg&nbsp;is&nbsp;(only)&nbsp;used&nbsp;as&nbsp;human-readable&nbsp;caller&nbsp;ID&nbsp;when&nbsp;logging&nbsp;for&nbsp;debug&nbsp;purposes.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do_Stop</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;per_who:&nbsp;&nbsp;&nbsp;&nbsp;String,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reply:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Void&nbsp;-&gt;&nbsp;Void</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop_server_hostthread_if_running:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do_Stop&nbsp;-&gt;&nbsp;Void;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do_Echo</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;what:&nbsp;&nbsp;String,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Primarily&nbsp;to&nbsp;test&nbsp;that&nbsp;the&nbsp;server&nbsp;is&nbsp;running.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reply:&nbsp;String&nbsp;-&gt;&nbsp;Void</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do_Echo&nbsp;-&gt;&nbsp;Void;</CODE><BR><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do_Note_Iod_Reader</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;io_descriptor:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wio::Iod,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_fn:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wio::Iod&nbsp;-&gt;&nbsp;Void&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Call&nbsp;this&nbsp;closure&nbsp;("function")&nbsp;on&nbsp;iod&nbsp;whenever&nbsp;input&nbsp;is&nbsp;available.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note_iod_reader:&nbsp;Do_Note_Iod_Reader&nbsp;-&gt;&nbsp;Void;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drop_iod_reader:&nbsp;wio::Iod&nbsp;-&gt;&nbsp;Void;</CODE><BR><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do_Note_Iod_Writer</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;io_descriptor:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wio::Iod,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_fn:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wio::Iod&nbsp;-&gt;&nbsp;Void&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Call&nbsp;this&nbsp;closure&nbsp;("function")&nbsp;on&nbsp;iod&nbsp;whenever&nbsp;input&nbsp;is&nbsp;available.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note_iod_writer:&nbsp;Do_Note_Iod_Writer&nbsp;-&gt;&nbsp;Void;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drop_iod_writer:&nbsp;wio::Iod&nbsp;-&gt;&nbsp;Void;</CODE><BR><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do_Note_Iod_Oobder</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;io_descriptor:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wio::Iod,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oobd_fn:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wio::Iod&nbsp;-&gt;&nbsp;Void&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Call&nbsp;this&nbsp;closure&nbsp;("function")&nbsp;on&nbsp;iod&nbsp;whenever&nbsp;out-of-band-data&nbsp;("oobd")&nbsp;is&nbsp;available.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note_iod_oobder:&nbsp;Do_Note_Iod_Oobder&nbsp;-&gt;&nbsp;Void;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drop_iod_oobder:&nbsp;wio::Iod&nbsp;-&gt;&nbsp;Void;</CODE><BR><BR><BR>
<CODE>#&nbsp;test:&nbsp;String&nbsp;-&gt;&nbsp;Void;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;This&nbsp;is&nbsp;nominally&nbsp;temporary&nbsp;debug&nbsp;code;&nbsp;the&nbsp;String&nbsp;(only)&nbsp;identifies&nbsp;the&nbsp;caller&nbsp;for&nbsp;debug&nbsp;purposes.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;WE&nbsp;ASSUME&nbsp;ONLY&nbsp;ONE&nbsp;CALLER&nbsp;AT&nbsp;A&nbsp;TIME,&nbsp;SO&nbsp;WE&nbsp;DON'T&nbsp;WORRY&nbsp;ABOUT&nbsp;MUTUAL&nbsp;EXCLUSION.</CODE><BR><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get_timeout_interval:&nbsp;&nbsp;Void&nbsp;-&gt;&nbsp;tim::Time;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_timeout_interval:&nbsp;&nbsp;tim::Time&nbsp;-&gt;&nbsp;Void;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;main&nbsp;job&nbsp;of&nbsp;io-wait-hostthread.pkg&nbsp;is&nbsp;to&nbsp;sit</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;eternally&nbsp;in&nbsp;loop&nbsp;running&nbsp;&nbsp;wio::wait_for_io_opportunity.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;These&nbsp;two&nbsp;calls&nbsp;control&nbsp;the&nbsp;timeout&nbsp;for&nbsp;that&nbsp;call.</CODE><BR><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drop_per_loop_fn:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Ref&nbsp;(Void&nbsp;-&gt;&nbsp;Void))&nbsp;-&gt;&nbsp;Void;</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note_per_loop_fn:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Ref&nbsp;(Void&nbsp;-&gt;&nbsp;Void))&nbsp;-&gt;&nbsp;Void;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Call&nbsp;will&nbsp;be&nbsp;ignored&nbsp;if&nbsp;given&nbsp;refcell&nbsp;is&nbsp;already&nbsp;present&nbsp;in&nbsp;internal&nbsp;list.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;io_wait_hostthread&nbsp;timeslicer&nbsp;uses&nbsp;us&nbsp;to&nbsp;generate</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;its&nbsp;(approximately)&nbsp;50Hz&nbsp;timeslicing&nbsp;"clock".&nbsp;It&nbsp;uses</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note_per_loop_fn</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;register&nbsp;a&nbsp;function&nbsp;with&nbsp;us&nbsp;to&nbsp;be&nbsp;called&nbsp;once</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;per&nbsp;outer&nbsp;loop&nbsp;(and&nbsp;consequently&nbsp;approximately&nbsp;once</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;per&nbsp;timeout&nbsp;interval).</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;For&nbsp;generality&nbsp;we&nbsp;internally&nbsp;support&nbsp;a&nbsp;list&nbsp;of&nbsp;such</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;per-loop&nbsp;fns&nbsp;rather&nbsp;than&nbsp;a&nbsp;single&nbsp;such&nbsp;fn,&nbsp;all&nbsp;of&nbsp;which</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;called&nbsp;once&nbsp;per&nbsp;outer&nbsp;loop.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;For&nbsp;flexibility&nbsp;we&nbsp;also&nbsp;support&nbsp;removing&nbsp;per-loop&nbsp;fns</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;from&nbsp;our&nbsp;internal&nbsp;list&nbsp;via</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note_per_loop_fn</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(This&nbsp;might&nbsp;be&nbsp;needed&nbsp;if&nbsp;switching&nbsp;to&nbsp;an&nbsp;entirely</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;different&nbsp;threadkit&nbsp;scheduler,&nbsp;say.)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;To&nbsp;do&nbsp;this&nbsp;we&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;compare&nbsp;list&nbsp;entries</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;for&nbsp;equality.&nbsp;Equality&nbsp;comparisons&nbsp;are&nbsp;not&nbsp;supported</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;for&nbsp;Void-&gt;Void&nbsp;values,&nbsp;but&nbsp;they&nbsp;are&nbsp;supported&nbsp;for</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;refcells&nbsp;--&nbsp;this&nbsp;is&nbsp;the&nbsp;main&nbsp;reason&nbsp;we&nbsp;wrap&nbsp;per-loop&nbsp;fns</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;in&nbsp;refcells&nbsp;in&nbsp;these&nbsp;two&nbsp;calls.&nbsp;&nbsp;(We&nbsp;never&nbsp;assign&nbsp;to</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;these&nbsp;refcells,&nbsp;although&nbsp;our&nbsp;client&nbsp;--&nbsp;threadkit&nbsp;scheduler</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;--&nbsp;could&nbsp;do&nbsp;so&nbsp;if&nbsp;it&nbsp;wished.)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Note&nbsp;that&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;lot&nbsp;of&nbsp;I/O&nbsp;going&nbsp;on,&nbsp;the</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;fn&nbsp;may&nbsp;be&nbsp;called&nbsp;much&nbsp;more&nbsp;frequently&nbsp;than&nbsp;the</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;timeout&nbsp;interval&nbsp;would&nbsp;suggest.&nbsp;&nbsp;It&nbsp;is&nbsp;up&nbsp;to&nbsp;the</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;client&nbsp;to&nbsp;deal&nbsp;with&nbsp;this,&nbsp;if&nbsp;it&nbsp;is&nbsp;a&nbsp;problem.</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_doing_useful_work:&nbsp;&nbsp;&nbsp;Void&nbsp;-&gt;&nbsp;Bool;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;This&nbsp;is&nbsp;support&nbsp;for</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_runnable_threads_left__fate</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;from</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_src_lib_thread-kit_src_glue_threadkit-base-for-os-g_pkg.html#src/lib/src/lib/thread-kit/src/glue/threadkit-base-for-os-g.pkg"><TT>src/lib/src/lib/thread-kit/src/glue/threadkit-base-for-os-g.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;which&nbsp;is&nbsp;tasked&nbsp;with&nbsp;exit()ing&nbsp;if&nbsp;the&nbsp;system&nbsp;is</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;deadlocked&nbsp;--&nbsp;which&nbsp;is&nbsp;to&nbsp;say,&nbsp;no&nbsp;thread&nbsp;ready</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;run&nbsp;and&nbsp;provably&nbsp;no&nbsp;prospect&nbsp;of&nbsp;ever&nbsp;having</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;a&nbsp;thread&nbsp;ready&nbsp;to&nbsp;run.</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;we&nbsp;are&nbsp;listening&nbsp;on&nbsp;any&nbsp;fd,&nbsp;then&nbsp;we&nbsp;can&nbsp;eventually</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;wake&nbsp;up&nbsp;some&nbsp;thread&nbsp;when&nbsp;input&nbsp;arrives&nbsp;on&nbsp;that&nbsp;fd,&nbsp;so</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;system&nbsp;is&nbsp;not&nbsp;provably&nbsp;deadlocked&nbsp;and</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;no_runnable_threads_left__fate()&nbsp;should&nbsp;not&nbsp;exit().</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR>
<CODE>end;</CODE><BR><BR>
<CODE>##&nbsp;Code&nbsp;by&nbsp;Jeff&nbsp;Prothero:&nbsp;Copyright&nbsp;(c)&nbsp;2010-2015,</CODE><BR>
<CODE>##&nbsp;released&nbsp;per&nbsp;terms&nbsp;of&nbsp;SMLNJ-COPYRIGHT.</CODE><BR>
</P>

<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-src_lib_std_src_hostthread_io-bound-task-hostthreads_api.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Codebase__api_Files.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-src_lib_std_src_hostthread_template-hostthread_api.html"><IMG SRC="next_motif.gif" ALT="Next"></A></BODY>
</HTML>
