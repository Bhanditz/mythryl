<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>src/lib/x-kit/widget/old/fancy/2d-graphics/scalable-font.pkg</TITLE>
</HEAD>
<BODY >
<A HREF="my-src_lib_x-kit_widget_old_basic_xevent-mail-router_pkg.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Codebase__pkg_Files.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-src_lib_x-kit_widget_old_fancy_graphviz_font-family-cache_pkg.html"><IMG SRC="next_motif.gif" ALT="Next"></A><HR>
<H3 CLASS="subsection"><A NAME="htoc3370">15.4.1482</A>  src/lib/x-kit/widget/old/fancy/2d-graphics/scalable-font.pkg</H3><P>
<A NAME="src/lib/x-kit/widget/old/fancy/2d-graphics/scalable-font.pkg"></A>
<CODE>##&nbsp;scalable-font.pkg</CODE><BR><BR><BR><BR>
<CODE>api&nbsp;SCALABLE_FONT&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;api</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;w:&nbsp;&nbsp;WIDGET</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;enum&nbsp;font_style&nbsp;=&nbsp;Normal&nbsp;</CODE><CODE>|&nbsp;Italic&nbsp;|&nbsp;Bold</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;dfltFontSz:&nbsp;&nbsp;Int</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;font_imp</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;fontServer:&nbsp;&nbsp;(w::root&nbsp;*&nbsp;w::view&nbsp;*&nbsp;List(&nbsp;w::Arg&nbsp;)&nbsp;)&nbsp;-&gt;&nbsp;font_imp</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;findFont:&nbsp;&nbsp;font_imp&nbsp;-&gt;&nbsp;(font_style&nbsp;*&nbsp;Int)&nbsp;-&gt;&nbsp;Null_Or(&nbsp;w::XC::font&nbsp;)</CODE><BR><BR>
<CODE>&nbsp;&nbsp;end</CODE><BR><BR>
<CODE>package&nbsp;ScalableFont:&nbsp;&nbsp;SCALABLE_FONT</CODE><BR>
<CODE>=</CODE><BR>
<CODE>pkg</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;w&nbsp;=&nbsp;widget</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;threadkit</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;enum&nbsp;font_style&nbsp;=&nbsp;Normal&nbsp;</CODE><CODE>|&nbsp;Italic&nbsp;|&nbsp;Bold</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Eventually,&nbsp;this&nbsp;should&nbsp;come&nbsp;from&nbsp;the&nbsp;style&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;dfltFontSz&nbsp;=&nbsp;12&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;points&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;rmFont&nbsp;=&nbsp;"-adobe-times-medium-r-normal--*-%d-*-*-p-*-iso8859-1"</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;itFont&nbsp;=&nbsp;"-adobe-times-medium-i-normal--*-%d-*-*-p-*-iso8859-1"</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;bfFont&nbsp;=&nbsp;"-adobe-times-bold-r-normal--*-%d-*-*-p-*-iso8859-1"</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;fmtRmFont&nbsp;=&nbsp;format::format&nbsp;rmFont</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;fmtItFont&nbsp;=&nbsp;format::format&nbsp;itFont</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;fmtBfFont&nbsp;=&nbsp;format::format&nbsp;bfFont</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Note&nbsp;that&nbsp;font&nbsp;sizes&nbsp;are&nbsp;specified&nbsp;in&nbsp;tenths&nbsp;of&nbsp;a&nbsp;point&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;fmtFontName&nbsp;(Normal,&nbsp;size)&nbsp;=&nbsp;fmtRmFont&nbsp;[format::INT&nbsp;(size*10)]</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;fmtFontName&nbsp;(Italic,&nbsp;size)&nbsp;=&nbsp;fmtItFont&nbsp;[format::INT&nbsp;(size*10)]</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;fmtFontName&nbsp;(Bold,&nbsp;&nbsp;&nbsp;size)&nbsp;=&nbsp;fmtBfFont&nbsp;[format::INT&nbsp;(size*10)]</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;enum&nbsp;font_imp&nbsp;=&nbsp;FS&nbsp;of&nbsp;{</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plea:&nbsp;&nbsp;&nbsp;chan(&nbsp;font_style&nbsp;*&nbsp;Int&nbsp;),</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reply:&nbsp;&nbsp;chan(&nbsp;&nbsp;Null_Or(&nbsp;&nbsp;w::XC::font&nbsp;)&nbsp;)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;fontServer&nbsp;(root,&nbsp;view,&nbsp;args)&nbsp;=&nbsp;let</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plea&nbsp;=&nbsp;channel&nbsp;()&nbsp;and&nbsp;reply&nbsp;=&nbsp;channel&nbsp;()</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFont&nbsp;=&nbsp;w::openFont&nbsp;root</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;loadFont&nbsp;(_,&nbsp;0)&nbsp;=&nbsp;NULL</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;loadFont&nbsp;(style,&nbsp;size)&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(THE&nbsp;(openFont&nbsp;(fmtFontName&nbsp;(style,&nbsp;size))))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;Font::FONT_NOT_FOUND&nbsp;=&gt;(</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file::write&nbsp;(file::stderr,&nbsp;cat&nbsp;[</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Font&nbsp;size",&nbsp;int::to_string&nbsp;size,&nbsp;"&nbsp;:&nbsp;not&nbsp;found\n"]</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loadFont&nbsp;(style,&nbsp;size&nbsp;-&nbsp;1))</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;handlePlea&nbsp;(fonts,&nbsp;(style,&nbsp;pleasz))&nbsp;=&nbsp;let</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;match&nbsp;(sty,&nbsp;s,&nbsp;_)&nbsp;=&nbsp;(sty&nbsp;=&nbsp;style)&nbsp;and&nbsp;(s&nbsp;=&nbsp;pleasz)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;list::find&nbsp;match&nbsp;fonts</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;(THE(_,&nbsp;_,&nbsp;f))&nbsp;=&gt;&nbsp;(send&nbsp;(reply,&nbsp;THE&nbsp;f);&nbsp;fonts)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;NULL&nbsp;=&gt;&nbsp;(case&nbsp;loadFont&nbsp;(style,&nbsp;pleasz)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;NULL&nbsp;=&gt;&nbsp;(send&nbsp;(reply,&nbsp;NULL);&nbsp;fonts)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;(THE&nbsp;f)&nbsp;=&gt;&nbsp;(</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;send&nbsp;(reply,&nbsp;THE&nbsp;f);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(style,&nbsp;pleasz,&nbsp;f)&nbsp;.&nbsp;fonts)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;end&nbsp;case</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;end&nbsp;case&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;loop&nbsp;flist&nbsp;=&nbsp;loop&nbsp;(handlePlea&nbsp;(flist,&nbsp;pull&nbsp;plea))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;make_thread&nbsp;"scalable_font"&nbsp;(\\&nbsp;()&nbsp;=&gt;&nbsp;loop[]);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FS&nbsp;{&nbsp;plea=plea,&nbsp;reply=reply&nbsp;}</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;findFont&nbsp;(FS&nbsp;{&nbsp;plea,&nbsp;reply&nbsp;}&nbsp;)&nbsp;size</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;send&nbsp;(plea,&nbsp;size);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pull&nbsp;reply</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</CODE><BR><BR>
<CODE>&nbsp;&nbsp;end</CODE><BR><BR>
</P>

<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-src_lib_x-kit_widget_old_basic_xevent-mail-router_pkg.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Codebase__pkg_Files.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-src_lib_x-kit_widget_old_fancy_graphviz_font-family-cache_pkg.html"><IMG SRC="next_motif.gif" ALT="Next"></A></BODY>
</HTML>
