<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>src/lib/compiler/debugging-and-profiling/profiling/add-per-fun-byte-counters-to-deep-syntax.pkg</TITLE>
</HEAD>
<BODY >
<A HREF="my-src_lib_compiler_back_top_translate_translate-deep-syntax-types-to-lambdacode_pkg.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Codebase__pkg_Files.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-src_lib_compiler_debugging-and-profiling_profiling_add-per-fun-call-counters-to-deep-syntax_pkg.html"><IMG SRC="next_motif.gif" ALT="Next"></A><HR>
<H3 CLASS="subsection"><A NAME="htoc2409">15.4.521</A>  src/lib/compiler/debugging-and-profiling/profiling/add-per-fun-byte-counters-to-deep-syntax.pkg</H3><P>
<A NAME="src/lib/compiler/debugging-and-profiling/profiling/add-per-fun-byte-counters-to-deep-syntax.pkg"></A>
<CODE>##&nbsp;add-per-fun-byte-counters-to-deep-syntax.pkg&nbsp;</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;2011-07-08&nbsp;CrT:&nbsp;&nbsp;The&nbsp;general&nbsp;idea&nbsp;here&nbsp;seems&nbsp;to&nbsp;be&nbsp;to&nbsp;establish</CODE><BR>
<CODE>#&nbsp;a&nbsp;hook&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;every&nbsp;function&nbsp;which&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;call</CODE><BR>
<CODE>#&nbsp;arbitrary&nbsp;profiling&nbsp;code.</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;In&nbsp;slightly&nbsp;more&nbsp;detail,&nbsp;the&nbsp;rough&nbsp;idea&nbsp;seems&nbsp;to&nbsp;be&nbsp;to&nbsp;call&nbsp;'enter'</CODE><BR>
<CODE>#&nbsp;once&nbsp;for&nbsp;each&nbsp;FN_IN_EXPRESSION&nbsp;with&nbsp;3&nbsp;args:</CODE><BR>
<CODE>#&nbsp;&nbsp;arg1&nbsp;is&nbsp;source&nbsp;code&nbsp;location;</CODE><BR>
<CODE>#&nbsp;&nbsp;arg2&nbsp;accumulates&nbsp;list&nbsp;of&nbsp;all&nbsp;functions&nbsp;we've&nbsp;tweaked&nbsp;this&nbsp;way;</CODE><BR>
<CODE>#&nbsp;&nbsp;arg3&nbsp;is&nbsp;the&nbsp;body&nbsp;of&nbsp;the&nbsp;fn</CODE><BR>
<CODE>#&nbsp;and&nbsp;then&nbsp;wrap&nbsp;body&nbsp;'expression'&nbsp;n&nbsp;to&nbsp;be&nbsp;&nbsp;enterexp(expression,n)</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;The&nbsp;rest&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;this&nbsp;file&nbsp;appears&nbsp;to&nbsp;just&nbsp;be&nbsp;doing&nbsp;a&nbsp;dagwalk</CODE><BR>
<CODE>#&nbsp;to&nbsp;find&nbsp;all&nbsp;FN_IN_EXPRESSION&nbsp;nodes&nbsp;and&nbsp;call&nbsp;'enter'&nbsp;on&nbsp;them.</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;Apparently&nbsp;"sprof"&nbsp;==&nbsp;"space&nbsp;profiling"&nbsp;and&nbsp;"tprof"&nbsp;==&nbsp;"time&nbsp;profiling".</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;add-per-fun-call-counters-to-deep-syntax.pkgappears&nbsp;to&nbsp;contain&nbsp;similar&nbsp;logic&nbsp;--&nbsp;but&nbsp;working.&nbsp;:-)</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;See&nbsp;also:</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_debugging-and-profiling_profiling_add-per-fun-call-counters-to-deep-syntax_pkg.html#src/lib/compiler/debugging-and-profiling/profiling/add-per-fun-call-counters-to-deep-syntax.pkg"><TT>src/lib/compiler/debugging-and-profiling/profiling/add-per-fun-call-counters-to-deep-syntax.pkg</TT></A><BR><CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_debugging-and-profiling_profiling_tdp-instrument_pkg.html#src/lib/compiler/debugging-and-profiling/profiling/tdp-instrument.pkg"><TT>src/lib/compiler/debugging-and-profiling/profiling/tdp-instrument.pkg</TT></A><BR><CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_back_top_closures_allocprof_pkg.html#src/lib/compiler/back/top/closures/allocprof.pkg"><TT>src/lib/compiler/back/top/closures/allocprof.pkg</TT></A><BR><BR><CODE>#&nbsp;Compiled&nbsp;by:</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_debugging-and-profiling_debugprof_sublib.html#src/lib/compiler/debugging-and-profiling/debugprof.sublib"><TT>src/lib/compiler/debugging-and-profiling/debugprof.sublib</TT></A><BR><BR><BR><CODE>stipulate</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;ds&nbsp;&nbsp;=&nbsp;&nbsp;deep_syntax;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;deep_syntax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_front_typer-stuff_deep-syntax_deep-syntax_pkg.html#src/lib/compiler/front/typer-stuff/deep-syntax/deep-syntax.pkg"><TT>src/lib/compiler/front/typer-stuff/deep-syntax/deep-syntax.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;pcs&nbsp;=&nbsp;&nbsp;per_compile_stuff;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;per_compile_stuff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_front_typer-stuff_main_per-compile-stuff_pkg.html#src/lib/compiler/front/typer-stuff/main/per-compile-stuff.pkg"><TT>src/lib/compiler/front/typer-stuff/main/per-compile-stuff.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;sci&nbsp;=&nbsp;&nbsp;sourcecode_info;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;sourcecode_info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_front_basics_source_sourcecode-info_pkg.html#src/lib/compiler/front/basics/source/sourcecode-info.pkg"><TT>src/lib/compiler/front/basics/source/sourcecode-info.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;syx&nbsp;=&nbsp;&nbsp;symbolmapstack;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;symbolmapstack&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_front_typer-stuff_symbolmapstack_symbolmapstack_pkg.html#src/lib/compiler/front/typer-stuff/symbolmapstack/symbolmapstack.pkg"><TT>src/lib/compiler/front/typer-stuff/symbolmapstack/symbolmapstack.pkg</TT></A><BR><CODE>herein</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;api&nbsp;Add_Per_Fun_Byte_Counters_To_Deep_Syntax&nbsp;{</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maybe_add_per_fun_byte_counters_to_deep_syntax</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;syx::Symbolmapstack,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pcs::Per_Compile_Stuff(&nbsp;ds::Declaration&nbsp;)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;sci::Sourcecode_Info</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;ds::Declaration</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;ds::Declaration;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR>
<CODE>end;</CODE><BR><BR><BR>
<CODE>###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"The&nbsp;honest&nbsp;truth&nbsp;is&nbsp;that&nbsp;having</CODE><BR>
<CODE>###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;lot&nbsp;of&nbsp;people&nbsp;staring&nbsp;at&nbsp;the&nbsp;code</CODE><BR>
<CODE>###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;does&nbsp;not&nbsp;find&nbsp;the&nbsp;really&nbsp;nasty&nbsp;bugs.</CODE><BR>
<CODE>###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;really&nbsp;nasty&nbsp;bugs&nbsp;are&nbsp;found</CODE><BR>
<CODE>###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;a&nbsp;couple&nbsp;of&nbsp;really&nbsp;smart&nbsp;people</CODE><BR>
<CODE>###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;who&nbsp;just&nbsp;kill&nbsp;themselves."</CODE><BR>
<CODE>###</CODE><BR>
<CODE>###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Bill&nbsp;Joy</CODE><BR><BR><BR>
<CODE>stipulate</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;ds&nbsp;&nbsp;=&nbsp;&nbsp;deep_syntax;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;deep_syntax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_front_typer-stuff_deep-syntax_deep-syntax_pkg.html#src/lib/compiler/front/typer-stuff/deep-syntax/deep-syntax.pkg"><TT>src/lib/compiler/front/typer-stuff/deep-syntax/deep-syntax.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;pcs&nbsp;=&nbsp;&nbsp;per_compile_stuff;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;per_compile_stuff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_front_typer-stuff_main_per-compile-stuff_pkg.html#src/lib/compiler/front/typer-stuff/main/per-compile-stuff.pkg"><TT>src/lib/compiler/front/typer-stuff/main/per-compile-stuff.pkg</TT></A><BR><CODE>herein</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;add_per_fun_byte_counters_to_deep_syntax</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add_Per_Fun_Byte_Counters_To_Deep_Syntax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Add_Per_Fun_Byte_Counters_To_Deep_Syntax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="#src/lib/compiler/debugging-and-profiling/profiling/add-per-fun-byte-counters-to-deep-syntax.pkg"><TT>src/lib/compiler/debugging-and-profiling/profiling/add-per-fun-byte-counters-to-deep-syntax.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;{</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;WARNING:&nbsp;THE&nbsp;MAIN&nbsp;CODE&nbsp;IS&nbsp;CURRENTLY&nbsp;TURNED&nbsp;OFF;&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;will&nbsp;merge&nbsp;in&nbsp;Chesakov's&nbsp;SProf&nbsp;in&nbsp;the&nbsp;future&nbsp;(ZHONG).</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;This&nbsp;fun&nbsp;is&nbsp;called&nbsp;(only)&nbsp;from&nbsp;&nbsp;&nbsp;maybe_instrument_deep_syntax&nbsp;&nbsp;&nbsp;in</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_toplevel_main_translate-raw-syntax-to-execode-g_pkg.html#src/lib/compiler/toplevel/main/translate-raw-syntax-to-execode-g.pkg"><TT>src/lib/compiler/toplevel/main/translate-raw-syntax-to-execode-g.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;maybe_add_per_fun_byte_counters_to_deep_syntax</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;dictionary,&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;per_compile_stuff&nbsp;as&nbsp;{&nbsp;issue_highcode_codetemp,&nbsp;...&nbsp;}:&nbsp;&nbsp;pcs::Per_Compile_Stuff(&nbsp;ds::Declaration&nbsp;)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;deep_syntax_tree</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deep_syntax_tree;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;};</CODE><BR>
<CODE>end;</CODE><BR><BR>
<CODE>/*&nbsp;</CODE><BR><BR>
<CODE>package&nbsp;{</CODE><BR><BR>
<CODE>local&nbsp;package&nbsp;sp&nbsp;=&nbsp;symbol_path</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;v&nbsp;=&nbsp;variables_and_constructors</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;m&nbsp;&nbsp;=&nbsp;module</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;b&nbsp;&nbsp;=&nbsp;Namings</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;hbo&nbsp;=&nbsp;highcode_baseops</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;deep_syntax&nbsp;variables_and_constructors&nbsp;types&nbsp;more_type_types</CODE><BR>
<CODE>in&nbsp;</CODE><BR><BR>
<CODE>infix&nbsp;--&gt;</CODE><BR>
<CODE>xsym&nbsp;=&nbsp;symbol::make_value_symbol&nbsp;"x"</CODE><BR><BR>
<CODE>fun&nbsp;maybe_add_per_fun_byte_counters_to_deep_syntax&nbsp;&nbsp;dictionary&nbsp;&nbsp;source&nbsp;&nbsp;deep_syntax_tree</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;*runtime_internals::rpc::sprofiling&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;runtime_internals&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_std_src_nj_runtime-internals_pkg.html#src/lib/std/src/nj/runtime-internals.pkg"><TT>src/lib/std/src/nj/runtime-internals.pkg</TT></A><BR><CODE>&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;deep_syntax_tree</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;let&nbsp;</CODE><BR><BR>
<CODE>my&nbsp;namelist:&nbsp;&nbsp;&nbsp;Ref(&nbsp;List(&nbsp;String&nbsp;)&nbsp;)&nbsp;=&nbsp;REF&nbsp;NIL</CODE><BR>
<CODE>namecount&nbsp;=&nbsp;REF&nbsp;0</CODE><BR><BR>
<CODE>alpha&nbsp;=&nbsp;TYPESCHEME_ARG&nbsp;0</CODE><BR><BR>
<CODE>my&nbsp;entervar&nbsp;as&nbsp;PLAIN_VARIABLE&nbsp;{&nbsp;type=entertype,&nbsp;...&nbsp;}&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;make_ordinary_variable&nbsp;(symbol::make_value_symbol&nbsp;"enter",&nbsp;HIGHCODE_VARIABLE&nbsp;(issue_highcode_codetemp()))</CODE><BR>
<CODE>entertype&nbsp;:=&nbsp;TYPESCHEME_TYPE&nbsp;{&nbsp;sign=[FALSE],</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typescheme&nbsp;=&nbsp;TYPESCHEME&nbsp;{&nbsp;arity=1,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body=tupleType[alpha,&nbsp;intType]&nbsp;--&gt;&nbsp;alpha&nbsp;}}</CODE><BR><BR><BR>
<CODE>enterexp&nbsp;=&nbsp;VARIABLE_IN_EXPRESSION&nbsp;(REF&nbsp;entervar,&nbsp;[])</CODE><BR><BR>
<CODE>fun&nbsp;clean&nbsp;names&nbsp;=&nbsp;names</CODE><BR>
<CODE>err&nbsp;=&nbsp;error_message::impossible</CODE><BR><BR><BR>
<CODE>#</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#</CODE><BR>
<CODE>fun&nbsp;enter((line_a,&nbsp;line_b),&nbsp;names,&nbsp;expression)&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;let&nbsp;fun&nbsp;dot&nbsp;(a,[z])&nbsp;=&nbsp;symbol::name&nbsp;z&nbsp;.&nbsp;a</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;dot&nbsp;(a,&nbsp;x&nbsp;.&nbsp;rest)&nbsp;=&nbsp;dot("."&nbsp;.&nbsp;symbol::name&nbsp;x&nbsp;.&nbsp;a,&nbsp;rest)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;dot&nbsp;_&nbsp;=&nbsp;err&nbsp;"no&nbsp;path&nbsp;in&nbsp;instrexp"</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;(fname,&nbsp;lineno_a,&nbsp;charpos_a)&nbsp;=&nbsp;sourcecode_info::filepos&nbsp;source&nbsp;line_a</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;(_,&nbsp;lineno_b,&nbsp;charpos_b)&nbsp;=&nbsp;sourcecode_info::filepos&nbsp;source&nbsp;line_b</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position&nbsp;=&nbsp;[fname,&nbsp;":",&nbsp;int::to_string&nbsp;lineno_a,&nbsp;".",</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int::to_string&nbsp;charpos_a,&nbsp;"-",&nbsp;int::to_string&nbsp;lineno_b,&nbsp;".",</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int::to_string&nbsp;charpos_b,&nbsp;":"]</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;&nbsp;cat&nbsp;(position&nbsp;@&nbsp;dot&nbsp;(["\n"],&nbsp;names))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;=&nbsp;*namecount</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;namecount&nbsp;:=&nbsp;index&nbsp;+&nbsp;1;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;namelist&nbsp;:=&nbsp;name&nbsp;.&nbsp;*namelist;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPLY_EXPRESSION&nbsp;(enterexp,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typer_junk::TUPLE_IN_EXPRESSION&nbsp;[expression,&nbsp;INT_CONSTANT_IN_EXPRESSION&nbsp;(int::to_string&nbsp;index,&nbsp;intType)])</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;end&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><BR><BR>
<CODE>fun&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;VALUE_DECLARATIONS&nbsp;vbl)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;fun&nbsp;instrvb&nbsp;(valueNaming&nbsp;as&nbsp;NAMED_VALUE&nbsp;{&nbsp;pattern=VARIABLE_IN_PATTERN&nbsp;(PLAIN_VARIABLE&nbsp;{&nbsp;access=PRIMOP&nbsp;_,&nbsp;...&nbsp;}&nbsp;),&nbsp;...&nbsp;}&nbsp;)&nbsp;=valueNaming</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrvb&nbsp;(valueNaming&nbsp;as&nbsp;NAMED_VALUE&nbsp;{&nbsp;pattern=TYPE_CONSTRAINT_PATTERN</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(VARIABLE_IN_PATTERN&nbsp;(PLAIN_VARIABLE&nbsp;{&nbsp;access=PRIMOP&nbsp;_,&nbsp;...&nbsp;}&nbsp;),&nbsp;_),&nbsp;...&nbsp;}&nbsp;)&nbsp;=&nbsp;valueNaming</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrvb&nbsp;(NAMED_VALUE&nbsp;{&nbsp;pattern&nbsp;as&nbsp;VARIABLE_IN_PATTERN&nbsp;(PLAIN_VARIABLE&nbsp;{&nbsp;path=sp::SYMBOL_PATH[n],&nbsp;...&nbsp;}&nbsp;),</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expression,&nbsp;typevars,&nbsp;generalized_typevars&nbsp;}&nbsp;)&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAMED_VALUE&nbsp;{&nbsp;pattern=pattern,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expression=instrexp&nbsp;(line,&nbsp;n&nbsp;.&nbsp;clean&nbsp;names)&nbsp;expression,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typevars=typevars,&nbsp;generalized_typevars=bound_typevar_refs&nbsp;}</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrvb&nbsp;(NAMED_VALUE&nbsp;{&nbsp;pattern&nbsp;as&nbsp;TYPE_CONSTRAINT_PATTERN&nbsp;(VARIABLE_IN_PATTERN&nbsp;(PLAIN_VARIABLE&nbsp;{&nbsp;path=sp::SYMBOL_PATH[n],&nbsp;...&nbsp;}&nbsp;),&nbsp;_),</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expression,&nbsp;typevars,&nbsp;generalized_typevars&nbsp;}&nbsp;)&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAMED_VALUE&nbsp;{&nbsp;pattern=pattern,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expression=instrexp&nbsp;(line,&nbsp;n&nbsp;.&nbsp;clean&nbsp;names)&nbsp;expression,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typevars=typevars,&nbsp;generalized_typevars=bound_typevar_refs&nbsp;}</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrvb&nbsp;(NAMED_VALUE&nbsp;{&nbsp;pattern,&nbsp;expression,&nbsp;typevars,&nbsp;generalized_typevars&nbsp;}&nbsp;)&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAMED_VALUE&nbsp;{&nbsp;pattern=pattern,&nbsp;expression=instrexp&nbsp;(line,&nbsp;names)&nbsp;expression,&nbsp;typevars=typevars,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generalized_typevars=bound_typevar_refs&nbsp;};</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE_DECLARATIONS&nbsp;(map&nbsp;instrvb&nbsp;vbl);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;RECURSIVE_VALUE_DECLARATIONS&nbsp;rvbl)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;fun&nbsp;instrrvb&nbsp;(NAMED_RECURSIVE_VALUE&nbsp;{&nbsp;var&nbsp;as&nbsp;PLAIN_VARIABLE&nbsp;{&nbsp;path=sp::SYMBOL_PATH[n],&nbsp;...&nbsp;},</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expression,&nbsp;result_type,&nbsp;raw_typevars,&nbsp;generalized_typevars&nbsp;}&nbsp;)&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAMED_RECURSIVE_VALUE&nbsp;{&nbsp;var=var,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expression=instrexp&nbsp;(line,&nbsp;n&nbsp;.&nbsp;clean&nbsp;names)&nbsp;expression,&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result_type=result_type,&nbsp;raw_typevars,&nbsp;generalized_typevars=bound_typevar_refs&nbsp;}</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrrvb&nbsp;_&nbsp;=&nbsp;err&nbsp;"RECURSIVE_VALUE_DECLARATIONS&nbsp;in&nbsp;SProf::instrdec";</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RECURSIVE_VALUE_DECLARATIONS&nbsp;(map&nbsp;instrrvb&nbsp;rvbl);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</CODE><BR><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;ABSTRACT_TYPE_DECLARATION&nbsp;{&nbsp;abstract_types,&nbsp;with_types,&nbsp;body&nbsp;}&nbsp;)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABSTRACT_TYPE_DECLARATION&nbsp;{&nbsp;abstract_types=abstractTypeConstructors,&nbsp;with_types=withTypeConstructors,&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body=instrdec&nbsp;(line,&nbsp;names,&nbsp;body)&nbsp;};</CODE><BR><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;PACKAGE_DECLARATION&nbsp;strbl)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PACKAGE_DECLARATION&nbsp;(map&nbsp;(\\&nbsp;named_package&nbsp;=&gt;&nbsp;instrstrb&nbsp;(line,&nbsp;names,&nbsp;named_package))&nbsp;strbl)</CODE><BR><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;ABSTRACT_PACKAGE_DECLARATIONS&nbsp;strbl)&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABSTRACT_PACKAGE_DECLARATIONS&nbsp;(map&nbsp;(\\&nbsp;named_package&nbsp;=&gt;&nbsp;instrstrb&nbsp;(line,&nbsp;names,&nbsp;named_package))&nbsp;strbl)</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;GENERIC_DECLARATION&nbsp;fctable)&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GENERIC_DECLARATION&nbsp;(map&nbsp;(\\&nbsp;generic_naming&nbsp;=&gt;&nbsp;instrfctb&nbsp;(line,&nbsp;names,&nbsp;generic_naming))&nbsp;fctable)</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;LOCAL_DECLARATION&nbsp;(localdec,&nbsp;visibledec))&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCAL_DECLARATION&nbsp;(instrdec&nbsp;(line,&nbsp;names,&nbsp;localdec),&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;visibledec))</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;SEQUENTIAL_DECLARATIONS&nbsp;decl)&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEQUENTIAL_DECLARATIONS&nbsp;(map&nbsp;(\\&nbsp;declaration&nbsp;=&gt;&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;declaration))&nbsp;decl)</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;SOURCE_CODE_REGION_FOR_DECLARATION&nbsp;(declaration,&nbsp;source_code_region))&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SOURCE_CODE_REGION_FOR_DECLARATION&nbsp;(instrdec&nbsp;(source_code_region,&nbsp;names,&nbsp;declaration),&nbsp;source_code_region)</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;other)&nbsp;=&nbsp;other</CODE><BR><BR>
<CODE>and&nbsp;/*&nbsp;instrstrexp&nbsp;(line,&nbsp;names,&nbsp;STRUCTstr&nbsp;{&nbsp;body,&nbsp;locations,&nbsp;str&nbsp;}&nbsp;)&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRUCTstr&nbsp;{&nbsp;body&nbsp;=&nbsp;(map&nbsp;(\\&nbsp;declaration&nbsp;=&gt;&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;declaration))&nbsp;body),</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;locations=locations,&nbsp;str=str&nbsp;}</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;*/&nbsp;instrstrexp&nbsp;(line,&nbsp;names,&nbsp;COMPUTED_PACKAGE&nbsp;{&nbsp;op,&nbsp;arg,&nbsp;parameterTypes,&nbsp;result,&nbsp;restypes&nbsp;}&nbsp;)&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMPUTED_PACKAGE&nbsp;{&nbsp;op=oper,&nbsp;arg=instrstrexp&nbsp;(line,&nbsp;names,&nbsp;arg),</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameterTypes=parameterTypes,&nbsp;result=result,&nbsp;restypes=restypes&nbsp;}</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrstrexp&nbsp;(line,&nbsp;names,&nbsp;VARIABLE_PACKAGE&nbsp;x)&nbsp;=&nbsp;VARIABLE_PACKAGE&nbsp;x</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrstrexp&nbsp;(line,&nbsp;names,&nbsp;PACKAGE_LET&nbsp;{&nbsp;declaration&nbsp;=&gt;&nbsp;d,&nbsp;expression&nbsp;=&gt;&nbsp;body&nbsp;})</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PACKAGE_LET&nbsp;{&nbsp;declaration&nbsp;=&gt;&nbsp;instrdec&nbsp;(line,&nbsp;names,&nbsp;d),&nbsp;expression&nbsp;=&gt;&nbsp;instrstrexp&nbsp;(line,&nbsp;names,&nbsp;body)}</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrstrexp&nbsp;(line,&nbsp;names,&nbsp;SOURCE_CODE_REGION_FOR_PACKAGE&nbsp;(body,&nbsp;source_code_region))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SOURCE_CODE_REGION_FOR_PACKAGE&nbsp;(instrstrexp&nbsp;(source_code_region,&nbsp;names,&nbsp;body),&nbsp;source_code_region)</CODE><BR><BR>
<CODE>and&nbsp;instrstrb&nbsp;(line,&nbsp;names,&nbsp;NAMED_PACKAGE&nbsp;{&nbsp;name,&nbsp;str,&nbsp;def&nbsp;}&nbsp;)&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAMED_PACKAGE&nbsp;{&nbsp;str=str,&nbsp;def=instrstrexp&nbsp;(line,&nbsp;name&nbsp;.&nbsp;names,&nbsp;def),&nbsp;name=name&nbsp;}</CODE><BR><BR>
<CODE>and&nbsp;instrfctb&nbsp;(line,&nbsp;names,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAMED_GENERIC&nbsp;{&nbsp;fct,&nbsp;name,&nbsp;def=GENERIC_DEFINITION&nbsp;{&nbsp;parameter,&nbsp;def=d,&nbsp;parameterTypes,&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fct=f,&nbsp;restypes&nbsp;}}&nbsp;)&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAMED_GENERIC&nbsp;{&nbsp;fct=fct,&nbsp;name=name,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def=GENERIC_DEFINITION&nbsp;{&nbsp;parameter=parameter,&nbsp;def=instrstrexp&nbsp;(line,&nbsp;name&nbsp;.&nbsp;names,&nbsp;d),</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fct=f,&nbsp;restypes=restypes,&nbsp;parameterTypes=parameterTypes&nbsp;}}</CODE><BR>
<CODE>&nbsp;&nbsp;</CODE><CODE>|&nbsp;instrfctb&nbsp;(line,&nbsp;names,&nbsp;generic_naming)&nbsp;=&nbsp;generic_naming</CODE><BR><BR>
<CODE>and&nbsp;instrexp&nbsp;(line,&nbsp;names)&nbsp;=</CODE><BR>
<CODE>&nbsp;let&nbsp;fun&nbsp;rule&nbsp;(RULE&nbsp;(p,&nbsp;e))&nbsp;=&nbsp;RULE&nbsp;(p,&nbsp;iexp&nbsp;e)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;iexp&nbsp;(RECORD_IN_EXPRESSION&nbsp;(l&nbsp;as&nbsp;_&nbsp;.&nbsp;_))&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;fun&nbsp;field&nbsp;(lab,&nbsp;expression)&nbsp;=&nbsp;(lab,&nbsp;iexp&nbsp;expression)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;enter&nbsp;(line,&nbsp;symbol::make_value_symbol&nbsp;(int::to_string&nbsp;(length&nbsp;l))&nbsp;.&nbsp;names,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RECORD_IN_EXPRESSION&nbsp;(map&nbsp;field&nbsp;l))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(VECTOR_IN_EXPRESSION&nbsp;(l,&nbsp;t))&nbsp;=&nbsp;VECTOR_IN_EXPRESSION((map&nbsp;iexp&nbsp;l),&nbsp;t)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(SEQUENTIAL_EXPRESSIONS&nbsp;l)&nbsp;=&nbsp;SEQUENTIAL_EXPRESSIONS&nbsp;(map&nbsp;iexp&nbsp;l)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(APPLY_EXPRESSION&nbsp;(f,&nbsp;a))&nbsp;=&nbsp;APPLY_EXPRESSION&nbsp;(iexp&nbsp;f,&nbsp;iexp&nbsp;a)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(TYPE_CONSTRAINT_EXPRESSION&nbsp;(e,&nbsp;t))&nbsp;=&nbsp;TYPE_CONSTRAINT_EXPRESSION&nbsp;(iexp&nbsp;e,&nbsp;t)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(EXCEPT_EXPRESSION&nbsp;(e,&nbsp;HANDLER&nbsp;(FN_EXPRESSION&nbsp;(l,&nbsp;t))))&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPT_EXPRESSION&nbsp;(iexp&nbsp;e,&nbsp;HANDLER&nbsp;(FN_EXPRESSION&nbsp;(map&nbsp;rule&nbsp;l,&nbsp;t)))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(EXCEPT_EXPRESSION&nbsp;(e,&nbsp;HANDLER&nbsp;h))&nbsp;=&nbsp;EXCEPT_EXPRESSION&nbsp;(iexp&nbsp;e,&nbsp;HANDLER&nbsp;(iexp&nbsp;h))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(RAISE_EXPRESSION&nbsp;(e,&nbsp;t))&nbsp;=&nbsp;RAISE_EXPRESSION&nbsp;(iexp&nbsp;e,&nbsp;t)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(LET_EXPRESSION&nbsp;(d,&nbsp;e))&nbsp;=&nbsp;LET_EXPRESSION&nbsp;(instrdec&nbsp;(line,&nbsp;names,&nbsp;d),&nbsp;iexp&nbsp;e)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(CASE_EXPRESSION&nbsp;(e,&nbsp;l,&nbsp;b))&nbsp;=&nbsp;CASE_EXPRESSION&nbsp;(iexp&nbsp;e,&nbsp;map&nbsp;rule&nbsp;l,&nbsp;b)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(FN_EXPRESSION&nbsp;(l,&nbsp;t))&nbsp;=&nbsp;enter&nbsp;(line,&nbsp;names,&nbsp;(FN_EXPRESSION&nbsp;(map&nbsp;rule&nbsp;l,&nbsp;t)))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(SOURCE_CODE_REGION_FOR_EXPRESSION&nbsp;(e,&nbsp;source_code_region))&nbsp;=&nbsp;SOURCE_CODE_REGION_FOR_EXPRESSION&nbsp;(instrexp&nbsp;(source_code_region,&nbsp;names)&nbsp;e,&nbsp;source_code_region)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;(e&nbsp;as&nbsp;VALCON_IN_EXPRESSION&nbsp;{&nbsp;valcon&nbsp;=&gt;&nbsp;VALCON&nbsp;{&nbsp;form,&nbsp;...&nbsp;},&nbsp;...&nbsp;})&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(case&nbsp;form</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;(UNTAGGED&nbsp;</CODE><CODE>|&nbsp;TAGGED&nbsp;_&nbsp;|&nbsp;REF&nbsp;|&nbsp;EXNFUN&nbsp;_)&nbsp;=&gt;&nbsp;</CODE><CODE>#&nbsp;ZHONG?</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;etaexpand&nbsp;e</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;_&nbsp;=&gt;&nbsp;e)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;iexp&nbsp;e&nbsp;=&nbsp;e&nbsp;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;etaexpand&nbsp;(e&nbsp;as&nbsp;VALCON_IN_EXPRESSION&nbsp;{&nbsp;typescheme_args&nbsp;=&gt;&nbsp;t,&nbsp;...&nbsp;})&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;v&nbsp;=&nbsp;PLAIN_VARIABLE&nbsp;{&nbsp;access=HIGHCODE_VARIABLE&nbsp;(issue_highcode_codetemp()),&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path=sp::SYMBOL_PATH&nbsp;[xsym],&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=REF&nbsp;types::UNDEFINED_TYPE&nbsp;}</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;FN_EXPRESSION([RULE&nbsp;(VARIABLE_IN_PATTERN&nbsp;v,&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enter&nbsp;(line,&nbsp;names,&nbsp;APPLY_EXPRESSION&nbsp;(e,&nbsp;VARIABLE_IN_EXPRESSION&nbsp;(REF&nbsp;v,&nbsp;[]))))],</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;types::UNDEFINED_TYPE)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;etaexpand&nbsp;_&nbsp;=&nbsp;err&nbsp;"etaexpand&nbsp;in&nbsp;add-per-fun-byte-counters-to-deep-syntax.pkg"</CODE><BR>
<CODE>&nbsp;&nbsp;in&nbsp;iexp</CODE><BR>
<CODE>&nbsp;end</CODE><BR><BR><BR>
<CODE>derefop&nbsp;=&nbsp;PLAIN_VARIABLE&nbsp;{&nbsp;path&nbsp;=&nbsp;sp::SYMBOL_PATH&nbsp;[symbol::make_value_symbol&nbsp;"!"],</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;=&nbsp;PRIMOP&nbsp;hbo::GET_REFCELL_CONTENTS,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;=&nbsp;REF&nbsp;(TYPESCHEME_TYPE&nbsp;{&nbsp;sign=[FALSE],</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typescheme&nbsp;=&nbsp;TYPESCHEME&nbsp;{&nbsp;arity=1,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPCON_TYPE&nbsp;(refType,[alpha])&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;alpha&nbsp;}}&nbsp;)&nbsp;}</CODE><BR><BR>
<CODE>registerType&nbsp;=&nbsp;&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;TYPESCHEME_TYPE&nbsp;{&nbsp;sign=[FALSE],</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typescheme&nbsp;=&nbsp;TYPESCHEME&nbsp;{&nbsp;arity=1,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body=&nbsp;TYPCON_TYPE&nbsp;(refType,[stringType&nbsp;--&gt;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(tupleType[alpha,&nbsp;intType]&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;alpha)])&nbsp;}}</CODE><BR><BR>
<CODE>registerVariable&nbsp;=&nbsp;core_access::getVariable&nbsp;"space_profiling_register"</CODE><BR><BR>
<CODE>deep_syntax_tree'&nbsp;=instrdec((0,&nbsp;0),&nbsp;NIL,&nbsp;deep_syntax_tree)&nbsp;</CODE><BR><BR>
<CODE>in&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;LOCAL_DECLARATION&nbsp;(</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE_DECLARATIONS&nbsp;[</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAMED_VALUE&nbsp;{</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern&nbsp;=&nbsp;VARIABLE_IN_PATTERN&nbsp;entervar,</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expression&nbsp;=&nbsp;APPLY_EXPRESSION&nbsp;(</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPLY_EXPRESSION&nbsp;(</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VARIABLE_IN_EXPRESSION&nbsp;(REF&nbsp;derefop,[]),</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VARIABLE_IN_EXPRESSION&nbsp;(REF&nbsp;(registerVariable),[])</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRING_CONSTANT_IN_EXPRESSION&nbsp;(cat&nbsp;(reverse&nbsp;*namelist))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typevars&nbsp;=&nbsp;REF&nbsp;NIL,</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generalized_typevars&nbsp;=&nbsp;[]</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],&nbsp;#&nbsp;&nbsp;ZHONG?&nbsp;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deep_syntax_tree'</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;)</CODE><BR><BR>
<CODE>end&nbsp;#&nbsp;&nbsp;function&nbsp;instrumentDeclaration&nbsp;</CODE><BR><BR>
<CODE>end&nbsp;#&nbsp;&nbsp;local&nbsp;</CODE><BR>
<CODE>}&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;package&nbsp;add_per_fun_byte_counters_to_deep_syntax&nbsp;</CODE><BR>
<CODE>*/</CODE><BR><BR><BR><BR><BR>
</P>

<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-src_lib_compiler_back_top_translate_translate-deep-syntax-types-to-lambdacode_pkg.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Codebase__pkg_Files.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-src_lib_compiler_debugging-and-profiling_profiling_add-per-fun-call-counters-to-deep-syntax_pkg.html"><IMG SRC="next_motif.gif" ALT="Next"></A></BODY>
</HTML>
