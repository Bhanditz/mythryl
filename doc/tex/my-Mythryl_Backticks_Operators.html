<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>Mythryl Backticks Operators</TITLE>
</HEAD>
<BODY >
<A HREF="my-Multi-file_Projects__Compiling_a_Stand-Alone_Executable.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Delving_Deeper.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-Mythryl_eval_Operators.html"><IMG SRC="next_motif.gif" ALT="Next"></A><HR>
<H3 CLASS="subsection"><A NAME="htoc82">5.3.17</A>  Mythryl Backticks Operators</H3><P>Bash, Perl and a number of other modern scripting-influenced languages 
supply a backticks operator returning the output from an executed 
shell expression:</P><PRE CLASS="verbatim">    #!/usr/bin/perl -w
    use strict;
    my $text = `ls -l`;
</PRE><P>Mythryl implements a similar backquote operator:</P><PRE CLASS="verbatim">    linux$ my

    eval:  text = `ls -l`;

    eval:  print text;
    total 5028
    drwxr-xr-x 2 cynbe cynbe    4096 2009-03-12 03:53 bin
    -rwxr-xr-x 1 cynbe cynbe     328 2007-11-26 00:34 Configure
    drwxr-xr-x 4 cynbe cynbe    4096 2009-03-02 23:34 doc
    drwxr-xr-x 2 cynbe cynbe    4096 2008-01-10 14:10 etc
    -rw-r--r-- 1 cynbe cynbe   30127 2009-03-12 03:51 LIBRARY_CONTENTS
    -rw-r--r-- 1 cynbe cynbe    1178 2009-03-12 03:56 main.log~
    -rw-r--r-- 1 cynbe cynbe 3558521 2009-03-12 03:53 MAKELIB_FILE_HIERARCHY.INFO~
    -rw-r--r-- 1 cynbe cynbe   25328 2009-03-08 22:57 Makefile
    -rwxr-xr-x 1 cynbe cynbe     386 2009-03-12 03:22 my-script
    -rw------- 1 cynbe cynbe  601330 2009-03-12 03:56 mythryl.compile.log
    -rw-r--r-- 1 cynbe cynbe  219341 2009-03-12 03:51 mythryld-9748.load.log
    -rw-r--r-- 1 cynbe cynbe  129121 2009-03-12 03:51 COMPILED_FILES_TO_LOAD
    -rw-r--r-- 1 cynbe cynbe  492671 2009-03-12 03:56 read-eval-print-loop.log~
    -rw-r--r-- 1 cynbe cynbe    3338 2009-03-04 17:37 README
    drwxr-xr-x 3 cynbe cynbe    4096 2009-03-09 05:10 sh
    drwxr-xr-x 6 cynbe cynbe    4096 2009-03-08 20:36 src
    -rw-r--r-- 1 cynbe cynbe     353 2007-09-06 21:52 TODO
    drwxr-xr-x 3 cynbe cynbe    4096 2009-02-21 14:05 try
    -rw-r--r-- 1 cynbe cynbe      27 2008-02-07 03:06 w
    -rwxr-xr-x 1 cynbe cynbe     124 2008-03-09 22:05 y
    -rwxr-xr-x 1 cynbe cynbe     501 2008-01-06 13:15 z
</PRE><P>A major difference is that early in compilation the Mythryl compiler 
expands this operator into a call to the <TT>back__ticks</TT> function.</P><P>This means that just by redefining the <TT>back__ticks</TT> function, the 
application programmer can redefine the meaning of the backticks 
construct.</P><P>This can be useful, for example, in a file defining many TCP/IP 
dotted-quad addresses, allowing syntax like</P><PRE CLASS="verbatim">    open_socket( `192.168.0.1` );
</PRE><P>to be substituted for perhaps</P><PRE CLASS="verbatim">    open_socket( IP_ADDRESS (192, 168, 0, 1) );
</PRE><P>If the construct is being used only once or twice, this is not a 
significant win, but if a long file configuring (say) a 
mail transport agent contains hundreds of such constructs, the 
difference in readability may be substantial.</P><P>A similar <TT>dot__backticks</TT> operator is also implemented by 
the Mythryl front end, expanding from syntax like</P><PRE CLASS="verbatim">    open_socket( .`192.168.0.1` );
</PRE><P>By defining <TT>dot__backticks</TT>, you can make the construct 
do whatever you want with the quoted string:</P><PRE CLASS="verbatim">    linux$ my

    eval:  dot__backticks = toupper;

    eval:  .`this is weird`;
    "THIS IS WEIRD"
</PRE><P>To implement the above IP address facility we might write something like:</P><PRE CLASS="verbatim">    #!/usr/bin/mythryl

    Ip_Address = IP_ADDRESS (Int, Int, Int, Int);

    fun dot__backticks  ip_address_string
        =
        case (regex::find_first_match_to_regex_and_return_all_groups
                  ./^(\d+)\.(\d+)\.(\d+)\.(\d+)$/
                  ip_address_string)

        THE [ a, b, c, d ]   =&gt; IP_ADDRESS( atoi a, atoi b, atoi c, atoi d );
        _                    =&gt; raise exception DIE "Invalid IP address syntax";
        esac;
</PRE><P>With these definitions in place we can do:</P><PRE CLASS="verbatim">    eval:  .`123.194.12.14`;
    IP_ADDRESS (123, 194, 12, 14)

    eval:  .`123.43.23`;
    unCaUght exception DIE [DIE: Invalid IP address syntax]
</PRE><P>The Mythryl standard library assigns no default definition to 
the <TT>dot__backticks</TT> function.</P><P>In a similar vein, <TT>."a b c d"</TT> expands early in the Mythryl front 
end into <TT>dot__qquotes "a b c d"</TT>. 
The <A HREF="my-scripting_globals.html#pkg:scripting_globals">scripting_globals</A> package sets <TT>dot__qquotes</TT> to <TT>words</TT> which in turn is defined as</P><BLOCKQUOTE CLASS="quotation">
        words = <A HREF="my-string.html#pkg:string">string</A>::tokens <A HREF="my-string.html#pkg:string">char</A>::is_space;</BLOCKQUOTE><P>Consequently, by default this construct provides a convenient way 
to specify lists of short words. It is somewhat like the Perl 
<TT>qw/.../</TT> construct:</P><PRE CLASS="verbatim">    linux&gt; my

    eval:  ."a b c d e f";

    ["a", "b", "c", "d", "e", "f"]
</PRE><P>This can substantially improve readability in certain sorts of programming. </P><P>Once again, by redefining <TT>dot__qquotes</TT> the application programmer may repurpose 
this facility for other needs:</P><PRE CLASS="verbatim">    linux$ my

    eval:  dotqquotes__op = implode o shuffle o explode;

    eval:  ."abcdefgh"
    "hcdefgba"
</PRE><P>In similar fashion 
<TT>.&#X2019;foo&#X2019;</TT> expands into a call to <TT>dot__quotes</TT>, 
<TT>.&lt;foo&gt;</TT> expands into a call to <TT>dot__brokets</TT>, 
<TT>.|foo|</TT> expands into a call to <TT>dot__barets</TT>, <TT>.#foo#</TT> expands 
into a call to <TT>dot__hashets</TT> and <TT>./foo/</TT> expands into a call to 
<TT>dot__slashets</TT>. All of these functions default to the identity function. 
Also, the only escape sequence recognized within any of these quotation constructs 
is doubling of the terminator to include it in the string; for example <TT>.#foo##bar#</TT> 
is equivalent to <TT>"foo#bar</TT>. This makes them useful for avoiding the need to 
double all backslashes in regular expressions.</P>

<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-Multi-file_Projects__Compiling_a_Stand-Alone_Executable.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Delving_Deeper.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-Mythryl_eval_Operators.html"><IMG SRC="next_motif.gif" ALT="Next"></A></BODY>
</HTML>
