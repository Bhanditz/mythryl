<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<LINK REL=STYLESHEET type="text/css" HREF="local.css">
<LINK rel="stylesheet" type="text/css" href="book.css">
<TITLE>src/lib/compiler/back/low/regor/regor-leftist-tree-priority-queue-g.pkg</TITLE>
</HEAD>
<BODY >
<A HREF="my-src_lib_compiler_back_low_regor_regor-deadcode-zapper-g_pkg.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Codebase__pkg_Files.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-src_lib_compiler_back_low_regor_regor-ram-merging-g_pkg.html"><IMG SRC="next_motif.gif" ALT="Next"></A><HR>
<H3 CLASS="subsection"><A NAME="htoc2252">15.4.364</A>  src/lib/compiler/back/low/regor/regor-leftist-tree-priority-queue-g.pkg</H3><P>
<A NAME="src/lib/compiler/back/low/regor/regor-leftist-tree-priority-queue-g.pkg"></A>
<CODE>##&nbsp;regor-leftist-tree-priority-queue-g.pkg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"regor"&nbsp;is&nbsp;a&nbsp;contraction&nbsp;of&nbsp;"register&nbsp;allocator"</CODE><BR><BR>
<CODE>#&nbsp;Compiled&nbsp;by:</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_back_low_lib_lowhalf_lib.html#src/lib/compiler/back/low/lib/lowhalf.lib"><TT>src/lib/compiler/back/low/lib/lowhalf.lib</TT></A><BR><BR><CODE>#&nbsp;Priority&nbsp;Queue.&nbsp;&nbsp;Let's&nbsp;hope&nbsp;the&nbsp;compiler&nbsp;will&nbsp;inline&nbsp;it&nbsp;for&nbsp;performance</CODE><BR><BR>
<CODE>#&nbsp;We&nbsp;already&nbsp;have&nbsp;in&nbsp;the&nbsp;system</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_graph_node-priority-queue-g_pkg.html#src/lib/graph/node-priority-queue-g.pkg"><TT>src/lib/graph/node-priority-queue-g.pkg</TT></A><BR><CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_src_leftist-tree-priority-queue_pkg.html#src/lib/src/leftist-tree-priority-queue.pkg"><TT>src/lib/src/leftist-tree-priority-queue.pkg</TT></A><BR><CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_src_leftist-heap-priority-queue-g_pkg.html#src/lib/src/leftist-heap-priority-queue-g.pkg"><TT>src/lib/src/leftist-heap-priority-queue-g.pkg</TT></A><BR><CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_src_heap-priority-queue_pkg.html#src/lib/src/heap-priority-queue.pkg"><TT>src/lib/src/heap-priority-queue.pkg</TT></A><BR><CODE>#</CODE><BR>
<CODE>#&nbsp;Do&nbsp;we&nbsp;really&nbsp;need&nbsp;this&nbsp;one&nbsp;as&nbsp;well?</CODE><BR>
<CODE>#&nbsp;If&nbsp;so,&nbsp;we&nbsp;should&nbsp;move&nbsp;it&nbsp;into&nbsp;the&nbsp;library&nbsp;--&nbsp;there's&nbsp;nothing&nbsp;regor-specific&nbsp;about&nbsp;it.</CODE><BR>
<CODE>#&nbsp;If&nbsp;not,&nbsp;we&nbsp;should&nbsp;replace&nbsp;it&nbsp;with&nbsp;one&nbsp;of&nbsp;the&nbsp;library&nbsp;implementations.</CODE><BR>
<CODE>#&nbsp;--&nbsp;2011-06-07&nbsp;CrT&nbsp;XXX&nbsp;BUGGO&nbsp;FIXME</CODE><BR><BR><BR>
<CODE>###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Everything&nbsp;that&nbsp;can&nbsp;be&nbsp;invented&nbsp;has&nbsp;been&nbsp;invented.</CODE><BR>
<CODE>###</CODE><BR>
<CODE>###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Charles&nbsp;H.&nbsp;Duell,&nbsp;Commissioner,&nbsp;US&nbsp;Patent&nbsp;Office,&nbsp;1899</CODE><BR><BR><BR>
<CODE>#&nbsp;We&nbsp;are&nbsp;invoked&nbsp;from:</CODE><BR>
<CODE>#</CODE><BR>
<CODE>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_back_low_regor_iterated-register-coalescing_pkg.html#src/lib/compiler/back/low/regor/iterated-register-coalescing.pkg"><TT>src/lib/compiler/back/low/regor/iterated-register-coalescing.pkg</TT></A><BR><CODE>#</CODE><BR>
<CODE>generic&nbsp;package&nbsp;&nbsp;&nbsp;regor_leftist_tree_priority_queue_g&nbsp;(</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;===================================</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;Element;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;less:&nbsp;&nbsp;(Element,&nbsp;Element)&nbsp;-&gt;&nbsp;Bool;</CODE><BR>
<CODE>)</CODE><BR>
<CODE>:&nbsp;(weak)&nbsp;Regor_Priority_Queue&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Regor_Priority_Queue&nbsp;&nbsp;is&nbsp;from&nbsp;&nbsp;&nbsp;</CODE><A HREF="my-src_lib_compiler_back_low_regor_regor-priority-queue_api.html#src/lib/compiler/back/low/regor/regor-priority-queue.api"><TT>src/lib/compiler/back/low/regor/regor-priority-queue.api</TT></A><BR><CODE>{</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;A&nbsp;leftist&nbsp;tree&nbsp;is&nbsp;a&nbsp;binary&nbsp;tree&nbsp;with&nbsp;priority&nbsp;ordering</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;with&nbsp;the&nbsp;invariant&nbsp;that&nbsp;the&nbsp;left&nbsp;branch&nbsp;is&nbsp;always&nbsp;the&nbsp;taller&nbsp;one&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;Element&nbsp;=&nbsp;Element;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;Priority_Queue&nbsp;=&nbsp;TREE&nbsp;&nbsp;(Element,&nbsp;Int,&nbsp;Priority_Queue,&nbsp;Priority_Queue)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</CODE><CODE>|&nbsp;EMPTY;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;merge'&nbsp;(EMPTY,&nbsp;EMPTY)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(EMPTY,&nbsp;0);</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;merge'&nbsp;(EMPTY,&nbsp;a&nbsp;as&nbsp;TREE(_,&nbsp;d,&nbsp;_,&nbsp;_))&nbsp;=&gt;&nbsp;(a,&nbsp;d);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;merge'&nbsp;(a&nbsp;as&nbsp;TREE(_,&nbsp;d,&nbsp;_,&nbsp;_),&nbsp;EMPTY)&nbsp;=&gt;&nbsp;(a,&nbsp;d);</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;merge'&nbsp;(a&nbsp;as&nbsp;TREE&nbsp;(x,&nbsp;d,&nbsp;l,&nbsp;r),&nbsp;b&nbsp;as&nbsp;TREE&nbsp;(y,&nbsp;d',&nbsp;l',&nbsp;r'))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(TREE&nbsp;(root,&nbsp;d_t,&nbsp;l,&nbsp;r),&nbsp;d_t)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;(root,&nbsp;l,&nbsp;r1,&nbsp;r2)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(less&nbsp;(x,&nbsp;y))&nbsp;&nbsp;&nbsp;(x,&nbsp;l,&nbsp;r,&nbsp;b);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(y,&nbsp;l',&nbsp;r',&nbsp;a);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;&nbsp;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;(r,&nbsp;d_r)&nbsp;=&nbsp;merge'&nbsp;(r1,&nbsp;r2);</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d_l&nbsp;=&nbsp;case&nbsp;l&nbsp;&nbsp;&nbsp;&nbsp;EMPTY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;0;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TREE(_,&nbsp;d,&nbsp;_,&nbsp;_)&nbsp;=&gt;&nbsp;d;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;esac;&nbsp;</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;(l,&nbsp;r,&nbsp;d_t)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(d_l&nbsp;&gt;=&nbsp;d_r)&nbsp;&nbsp;&nbsp;(l,&nbsp;r,&nbsp;d_l+1);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(r,&nbsp;l,&nbsp;d_r+1);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;end;</CODE><BR><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;merge&nbsp;(a,&nbsp;b)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;(merge'&nbsp;(a,&nbsp;b));</CODE><BR><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;fun&nbsp;add&nbsp;(x,&nbsp;EMPTY)</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TREE&nbsp;(x,&nbsp;1,&nbsp;EMPTY,&nbsp;EMPTY);</CODE><BR><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;(x,&nbsp;b&nbsp;as&nbsp;TREE&nbsp;(y,&nbsp;d',&nbsp;l',&nbsp;r'))</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(less&nbsp;(x,&nbsp;y))&nbsp;&nbsp;TREE&nbsp;(x,&nbsp;d'+1,&nbsp;b,&nbsp;EMPTY);</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;(merge'&nbsp;(TREE&nbsp;(x,&nbsp;1,&nbsp;EMPTY,&nbsp;EMPTY),&nbsp;b));</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;</CODE><BR>
<CODE>&nbsp;&nbsp;&nbsp;&nbsp;end;</CODE><BR>
<CODE>};</CODE><BR><BR>
</P>

<HR SIZE=2>
<DIV CLASS="center">
<FONT SIZE=1>Comments and suggestions to: </FONT><A HREF="mailto:bugs@mythryl.org"><FONT SIZE=1>bugs@mythryl.org</FONT></A></DIV>
<HR>
<A HREF="my-src_lib_compiler_back_low_regor_regor-deadcode-zapper-g_pkg.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A><A HREF="my-Codebase__pkg_Files.html"><IMG SRC="contents_motif.gif" ALT="Up"></A><A HREF="my-src_lib_compiler_back_low_regor_regor-ram-merging-g_pkg.html"><IMG SRC="next_motif.gif" ALT="Next"></A></BODY>
</HTML>
